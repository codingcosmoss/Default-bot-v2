import{P as C}from"./Page-mAivDXea.js";import{I as k}from"./Input-XTPd-9X-.js";import{_ as b,o as d,c as p,a as s,m as E,t as u,n as g,e as w,i as L,u as N,Q as I,P as S,J as O,S as P,A as y,r as f,b as c,w as h,F as _,v as x,d as V}from"./app-8i59_tig.js";import{P as j}from"./PrimaryButton-4iyouYaJ.js";import{P as B}from"./PrimaryButton2-zUn7s8oD.js";import{D as F}from"./DinamicForm-NgR-Hp5U.js";import"./Input-AJAfOiLl.js";import"./Loader-gbTB4BrO.js";const A={components:{Input:k},props:{Couple:{type:Boolean,default:!0},Title:{type:String,default:"Checkbox title"}}};function T(n,e,a,l,r,t){return d(),p("li",null,[s("input",{type:"checkbox",onInput:e[0]||(e[0]=i=>this.$emit("onCheck",!0))},null,32),E(" Â  "+u(a.Title),1)])}const D=b(A,[["render",T],["__scopeId","data-v-9f011b16"]]),K={props:{Couple:{type:Boolean,default:!0},Label:{type:String,default:"Input label"},Value:{type:[String,Boolean,Number],default:""},Type:{type:String,default:"text"},isError:{type:Boolean,default:!1}}},q={class:"mb-2.5 block text-black dark:text-white"},M=["value","type"];function U(n,e,a,l,r,t){return d(),p("div",{class:g(a.Couple?"mb-4.5":"w-full xl:w-1/2")},[s("label",q,u(a.Label),1),s("input",{value:a.Value,type:a.Type,class:g([a.isError==!0?"isError":"","rounded border-[1.5px] border-stroke bg-transparent py-20 px-2 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"]),placeholder:"Select subject",onInput:e[0]||(e[0]=i=>this.$emit("onInput",i.target.value)),style:{width:"80px",height:"40px"}},null,42,M)],2)}const z=b(K,[["render",U]]),J={props:{Couple:{type:Boolean,default:!0},Label:{type:String,default:"Input label"},Value:{type:[String,Boolean,Number],default:""},Type:{type:String,default:"text"},isError:{type:Boolean,default:!1},isLoginError:{type:Boolean,default:!1},message:{type:String,default:""}}},Q={class:"mb-2.5 block text-black dark:text-white"},G={key:0,class:"text-danger"};function H(n,e,a,l,r,t){return d(),p("div",{class:g(a.Couple?"mb-4.5":"w-full xl:w-1/2")},[s("label",Q,u(a.Label),1),s("select",{onInput:e[0]||(e[0]=i=>this.$emit("onSelect",i.target.value)),class:"w-full rounded border-[1.5px] border-stroke bg-transparent px-5 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"},[w(n.$slots,"default")],32),a.isError?(d(),p("p",G,u(a.message),1)):L("",!0)],2)}const R=b(J,[["render",H]]),W={data(){return{name:"",order:"",code:"",price:"",category:"",material_price:"",technic_price:"",status:1,isLoginError:!1,errorObj:{},personal_procent:!1,categories:[],personalAllProcents:[],FormErrors:[],summError:!1,Collections:[],CollectionId:0}},components:{DinamicForm:F,Select:R,PrimaryButton2:B,PrimaryButton:j,InputColor:z,Checkbox:D,Input:k},methods:{getName(n){return N().getName(n)},async getCategories(){const n=await I(null,1e3);this.categories=n.data.items},async getCollections(){const n=await S(1,1e3);this.Collections=n.data.items},validate(n){if(n.length==0)return!0;let e=[],a=0;return n.forEach((l,r)=>{(l.employee==""||l.procent<0||l.procent==""||l.type=="%"&&l.procent>100||l.procent.length>1&&l.procent.split("")[0]==0)&&e.push(r),l.type=="%"?a+=this.price*Number(l.procent)/100:a+=Number(l.procent),n.forEach((t,i)=>{i!=r&&t.employee==l.employee&&(e.push(r),e.push(i))})}),this.price<a||this.price<=0?(this.summError=!0,!1):(this.summError=!1,this.FormErrors=e,e.length==0)},async getModel(){var e=(await O(this.$route.query.id)).data;this.name=e.name,this.code=e.code,this.material_price=e.material_price.replace(/\s+/g,""),this.price=e.price.replace(/\s+/g,""),this.status=e.status,this.category=e.category_id,this.order=e.order,this.CollectionId=e.collection_id,this.technic_price=e.technic_price.replace(/\s+/g,"");let a=[];e.personalPrices.forEach((l,r)=>{a.push({employee:l.employee_id,procent:l.amount,type:l.type,index:r})}),this.personalAllProcents=a},async create(){if(this.validate(this.personalAllProcents)){let e=[];this.personalAllProcents.forEach((l,r)=>{let t=0;l.type=="%"?t+=this.price*Number(l.procent)/100:t+=Number(l.procent),e.push({employee_id:l.employee,amount:l.procent,result_price:t,type:l.type})});var n={name:this.name,order:this.order,code:this.code,price:this.price,category_id:this.category,material_price:this.material_price,technic_price:this.technic_price,collection_id:this.CollectionId,status:this.status,personal_procents:e};console.log("Data:",n);const a=await P(this.$route.query.id,n);a.status?(y("success","Updated successfully !"),this.$router.push("/services")):(this.errorObj=a.data,console.log(a.data),y("error","There is an error in the form"))}},hasKey(n){return n in this.errorObj}},mounted(){this.getCategories(),this.getModel(),this.getCollections()}},X={class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",style:{"justify-content":"flex-end"}},Y={class:"flex items-center gap-2"},Z={class:"font-medium text-primary"},$={class:"grid grid-cols-1 gap-9 sm:grid-cols-2"},ee={class:"flex flex-col gap-9"},re={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},te={class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},se={class:"font-semibold text-black dark:text-white"},oe={action:"#"},le={class:"p-6.5"},ae={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ne={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ie=s("option",null,"---",-1),ce=["value","selected"],ue={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},de={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},pe=s("option",{value:null},"---",-1),me=["value","selected"],fe={class:"flex flex-col gap-9"},be={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},he=s("div",{class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},[s("h3",{class:"font-semibold text-black dark:text-white"})],-1),_e={class:"mb-4.5 flex flex-col gap-6 xl:flex-row p-6.5"},ge=["selected"],ye=["selected"],xe={class:"pl-7 p-6.5"};function ke(n,e,a,l,r,t){const i=f("Input"),m=f("Select"),v=f("DinamicForm");return d(),p(_,null,[s("div",X,[s("nav",null,[s("ol",Y,[s("li",null,[s("a",{class:"font-medium cursor-pointer",onClick:e[0]||(e[0]=o=>this.$router.push("/services"))},u(t.getName("services"))+" /",1)]),s("li",Z,u(t.getName("update")),1)])])]),s("div",$,[s("div",ee,[s("div",re,[s("div",te,[s("h3",se,u(t.getName("services")),1)]),s("form",oe,[s("div",le,[s("div",ae,[c(i,{Couple:!1,Label:t.getName("name_content"),onOnInput:e[1]||(e[1]=o=>r.name=o),isError:t.hasKey("name"),message:r.errorObj.name,Value:r.name},null,8,["Label","isError","message","Value"]),c(i,{Couple:!1,Label:t.getName("code"),onOnInput:e[2]||(e[2]=o=>r.code=o),isError:t.hasKey("code"),message:r.errorObj.code,Value:r.code},null,8,["Label","isError","message","Value"])]),s("div",ne,[c(i,{Couple:!1,Label:t.getName("price"),onOnInput:e[3]||(e[3]=o=>r.price=o),isError:t.hasKey("price"),message:r.errorObj.price,Value:r.price,Type:"number"},null,8,["Label","isError","message","Value"]),c(m,{Couple:!1,Label:t.getName("category"),onOnSelect:e[4]||(e[4]=o=>this.category=o),isError:t.hasKey("category_id"),message:r.errorObj.category_id},{default:h(()=>[ie,(d(!0),p(_,null,x(r.categories,o=>(d(),p("option",{value:o.id,selected:o.id==this.category},u(o.name),9,ce))),256))]),_:1},8,["Label","isError","message"])]),s("div",ue,[c(i,{Couple:!1,Label:t.getName("material_price"),onOnInput:e[5]||(e[5]=o=>r.material_price=o),isError:t.hasKey("material_price"),message:r.errorObj.material_price,Type:"number",Value:r.material_price},null,8,["Label","isError","message","Value"]),c(i,{Couple:!1,Label:t.getName("technic_price"),onOnInput:e[6]||(e[6]=o=>r.technic_price=o),isError:t.hasKey("technic_price"),message:r.errorObj.technic_price,Type:"number",Value:r.technic_price},null,8,["Label","isError","message","Value"])]),s("div",de,[c(m,{Couple:!1,Label:t.getName("Collection"),onOnSelect:e[7]||(e[7]=o=>this.CollectionId=o),isError:t.hasKey("collection_id"),message:r.errorObj.collection_id},{default:h(()=>[pe,(d(!0),p(_,null,x(r.Collections,o=>(d(),p("option",{value:o.id,selected:o.id==this.CollectionId},u(o.name),9,me))),256))]),_:1},8,["Label","isError","message"])])])])])]),s("div",fe,[s("div",be,[he,s("div",_e,[c(i,{Couple:!1,Type:"number",Label:t.getName("Serial_number"),onOnInput:e[8]||(e[8]=o=>r.order=o),isError:t.hasKey("order"),message:r.errorObj.order,Value:r.order},null,8,["Label","isError","message","Value"]),c(m,{Couple:!1,Label:t.getName("status"),onOnSelect:e[9]||(e[9]=o=>this.status=o)},{default:h(()=>[s("option",{selected:r.status==1,value:1}," Active",8,ge),s("option",{selected:r.status==0,value:0}," Inactive",8,ye)]),_:1},8,["Label"])]),c(v,{personalProcents:r.personalAllProcents,summError:r.summError,errors:r.FormErrors,onData:e[10]||(e[10]=o=>(r.personalAllProcents=o,t.validate(r.personalAllProcents)))},null,8,["personalProcents","summError","errors"]),s("div",xe,[s("button",{onClick:e[11]||(e[11]=(...o)=>t.create&&t.create(...o)),class:"flex w-full justify-center rounded bg-primary p-3 font-medium text-gray"},u(t.getName("update")),1)])])])])],64)}const ve=b(W,[["render",ke]]),Ce={components:{FormLayouts:ve,Page:C}};function Ee(n,e,a,l,r,t){const i=f("FormLayouts"),m=f("Page");return d(),V(m,{Classes:!1,Animation:!1},{default:h(()=>[c(i)]),_:1})}const je=b(Ce,[["render",Ee]]);export{je as default};
