import{a as L,P as w}from"./Page-J7ry7tet.js";import{_ as E,a4 as S,u as V,a5 as x,H as _,a0 as I,A as f,a1 as N,c as B,w as o,r as u,o as a,e as n,a as l,b as c,d as C,F as T,f as P,t as b}from"./app-8LJP0yV3.js";import{a as M,B as U}from"./BasicTable-ojWB0Fu0.js";import{P as F}from"./PrimaryIconBtn--NOyd2jX.js";import{G}from"./GrowingLoader-FuF7Qd6J.js";import{D as H}from"./DefaultInput-f9zEhjKC.js";import{P as O}from"./PrimaryTable-S9eCcDSV.js";const R={components:{BaseCheck:S,PrimaryTable:O,BtnBox:M,DefaultInput:H,PrimaryBtn:L,GrowingLoader:G,PrimaryIconBtn:F,BasicTable:U,Page:w},setup(){return{counterStore:V()}},data(){return{items:[],item:[],paginateCount:10,column:"id",type:"desc",errors:[],loader:!1,menus:[],permissions:[],isAll:!1}},methods:{async index(){try{this.loader=!0;const e=await x();this.items=e.data,this.loader=!1}catch(e){_(this,e)}},async create(){try{this.loader=!0;let e={name:this.name,permissions:this.permissions};const s=await I(e);return s.status?(f("success",this.$t("create")),this.loader=!1,this.$router.push("/admin/roles"),!0):(this.errors=s.errors,this.loader=!1,f("error",this.$t("formError")),!1)}catch(e){return _(this,e),this.loader=!1,!1}},async update(){try{const s=await N({});return s.status?(f("success",this.$t("update")),!0):(this.errors=s.errors,f("error",this.$t("formError")),!1)}catch(e){return _(this,e),!1}},addPermission(e){this.permissions.find(i=>i==e.id)?this.permissions=this.permissions.filter(i=>i!=e.id):(this.menus.push(e.menu_id),this.permissions.push(e.id))},addAllPermission(){this.isAll=!this.isAll,this.isAll?(this.menus=[],this.permissions=[],this.items.forEach(e=>{this.menus.push(e.id),e.permissions.forEach(s=>{this.permissions.push(s.id)})})):(this.menus=[],this.permissions=[]),console.log(this.menus.length)},addMenu(e){this.menus.find(i=>i==e.id)?(this.menus=this.menus.filter(i=>i!=e.id),this.permissions=this.permissions.filter(i=>!e.permissions.find(y=>y.id==i))):(this.menus.push(e.id),e.permissions.forEach(i=>{this.permissions.includes(i.id)||this.permissions.push(i.id)}))}},mounted(){this.index()}},j={class:"row"},q={class:"col-xl-12"},z=n("br",null,null,-1),J={class:"text-primary"},K=n("h4",{class:"card-title mb-4 d-none d-xl-block"}," ",-1),Q=n("div",{class:"m-xl-5"},null,-1),W=n("br",null,null,-1),X={class:"text-primary"},Y=n("br",null,null,-1);function Z(e,s,i,y,d,h){const v=u("DefaultInput"),k=u("BaseBox"),m=u("BaseCheck"),$=u("PrimaryTable"),g=u("PrimaryBtn"),A=u("BtnBox"),D=u("Page");return a(),B(D,{Title:""},{default:o(()=>[n("div",j,[n("div",q,[l(k,{Col:"col-xl-6",Title:e.$t("Create")},{default:o(()=>[l(v,{Label:e.$t("RoleName"),Name:"name",Type:"text",Validated:d.errors,Value:e.name,onOnInput:s[0]||(s[0]=t=>(e.name=t,delete this.errors.name))},null,8,["Label","Validated","Value"])]),_:1},8,["Title"])]),l(k,{Col:"col-xl-6",Title:e.$t("Permissions")},{default:o(()=>[l(m,{onClick:s[1]||(s[1]=t=>h.addAllPermission()),isCheck:d.isAll,Title:e.$t("MarkAll")},null,8,["isCheck","Title"]),z,l($,{Th:[e.$t("Sections"),e.$t("Permissions")],Title:"Latest Transaction",Col:"col-lg-12"},{default:o(()=>[(a(!0),c(T,null,C(d.items.slice(0,d.items.length/2),t=>(a(),c("tr",null,[n("td",null,[l(m,{Title:e.$t(t.name),onClick:r=>h.addMenu(t),isCheck:this.menus.find(r=>r==t.id)},null,8,["Title","onClick","isCheck"])]),n("td",J,[(a(!0),c(T,null,C(t.permissions,r=>(a(),B(m,{onClick:p=>h.addPermission(r),isCheck:this.permissions.find(p=>p==r.id),Title:e.$t(r.name.toUpperCase())},null,8,["onClick","isCheck","Title"]))),256))])]))),256))]),_:1},8,["Th"])]),_:1},8,["Title"]),l(k,{Col:"col-xl-6",Title:""},{default:o(()=>[K,Q,W,l($,{Th:[e.$t("Sections"),e.$t("Permissions")],Title:"Latest Transaction",Col:"col-lg-12"},{default:o(()=>[(a(!0),c(T,null,C(d.items.slice(d.items.length/2,d.items.length),t=>(a(),c("tr",null,[n("td",null,[l(m,{Title:e.$t(t.name),onClick:r=>h.addMenu(t),isCheck:this.menus.find(r=>r==t.id)},null,8,["Title","onClick","isCheck"])]),n("td",X,[(a(!0),c(T,null,C(t.permissions,r=>(a(),B(m,{onClick:p=>h.addPermission(r),isCheck:this.permissions.find(p=>p==r.id),Title:e.$t(r.name.toUpperCase())},null,8,["onClick","isCheck","Title"]))),256))])]))),256))]),_:1},8,["Th"]),Y,l(A,null,{default:o(()=>[l(g,{class:"btn btn-secondary",onClick:s[2]||(s[2]=t=>this.$router.go(-1))},{default:o(()=>[P(b(e.$t("Close")),1)]),_:1}),P("   "),l(g,{onClick:s[3]||(s[3]=t=>h.create()),Loader:d.loader},{default:o(()=>[P(b(e.$t("Save")),1)]),_:1},8,["Loader"])]),_:1})]),_:1})])]),_:1})}const oe=E(R,[["render",Z]]);export{oe as default};
