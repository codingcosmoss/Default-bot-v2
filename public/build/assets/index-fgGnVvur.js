import{a as N,M as L,b as O,P as k}from"./Page-6po4WWvc.js";import{_ as M,u as R,bq as F,A as y,l,b2 as G,b3 as H,b4 as q,b5 as j,d as f,w as g,r as i,o as m,a as o,e as a,c as b,f as _,F as I,g as S,t as p,I as U,b as J}from"./app-qjkFfopU.js";import{B as K}from"./BasicTable-DVjjvWl8.js";import{P as Q,G as W}from"./GrowingLoader-C9t3ZqrR.js";import{D as X}from"./DefaultInput-qAxpax30.js";import{P as Y}from"./Paginate-pkoQmS0i.js";import{D as Z}from"./DefaultSelect-QS9w35hK.js";import{B as $,a as ee,I as te,D as se,H as re,R as ne,S as ie}from"./BasicSelect-q1jJDiaA.js";import{U as oe,C as v}from"./create-RuiXONc6.js";import"./ImageInput-rzGOIOcx.js";import"./boxCreate-_Z9U-oaD.js";import"./boxCreate-aQ7xexVm.js";const ae={components:{BasicSelect:$,BasicInput:ee,IconSelect:te,DefaultIconInput:se,Update:oe,Create:v,DefaultSelect:Z,Paginate:Y,DefaultInput:X,PrimaryBtn:N,ModalCentered:L,PrimaryIconBtn:Q,PrimaryButton:O,GrowingLoader:W,BasicTable:K,Page:k,Header:re,Report:ne,Search:ie,CreateMedicine:v},setup(){return{counterStore:R()}},data(){return{change:!1,isChange:!1,items:[],mloader:!1,item:[],boxItem:[],paginateCount:10,last_page:1,current_page:1,boxLast_page:1,boxCurrent_page:1,column:"id",type:"desc",errors:{date:this.$t("dateRequired"),buy_amount:this.$t("buyAmountError"),buy_price:this.$t("buyPriceError")},loader:!1,boxLoader:!1,boxItems:[],warehouses:Object,suppliers:Object,medicineCategories:[],boxSizes:[],drugCompanies:[],sizeTypes:[],medicines:[],dataErrors:[],paymentTypes:[],amount_paid:0,document:[],sortId:1}},methods:{deleteError(e){this.isChange=!this.isChange,this.dataErrors=this.dataErrors.filter(t=>t!="date"+e&&t!="buy_price"+e&&t!="bu_amount"+e)},async show(){try{const e=await F(this.$route.query.id);e.data.status==5&&(y("info",this.$t("SavedDocumentError")),this.$router.push("/admin/documents")),this.document=e.data}catch(e){l(this,e)}},changePrice(e,t){let c={...this.medicines[t]},h=this.counterStore.inputNumberFormat("medicinePrice"+t,c.buy_price,e);console.log("Amount:",h),c.buy_price=h,this.medicines[t]=c},addItem(e){let t=this.sortId+1,c={...e};c.sortId=t,c.buy_amount=1,this.sortId=t,this.medicines.push(c),this.isChange=!this.isChange},async search(e=""){try{if(this.loader=!0,e=="")return this.indexPaginates(),!0;const t=await documentSearch(e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(y("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return l(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;if((await documentDelete(e)).status){this.indexPaginates(this.current_page),y("success",this.$t("delete"));return}return y("error",this.$t("formError")),!1}catch(t){return l(this,t),!1}},async indexCategoryActives(){try{this.mloader=!0;const e=await G();this.medicineCategories=e.data,this.mloader=!1}catch(e){l(this,e)}},async indexBoxSizesActives(){try{this.mloader=!0;const e=await H();this.boxSizes=e.data,this.mloader=!1}catch(e){l(this,e)}},async indexCompaniesActives(){try{this.mloader=!0;const e=await q();this.drugCompanies=e.data,this.mloader=!1}catch(e){l(this,e)}},async indexTypesActives(){try{this.mloader=!0;const e=await j();this.sizeTypes=e.data,this.mloader=!1}catch(e){l(this,e)}}},mounted(){this.show(),this.indexCategoryActives(),this.indexBoxSizesActives(),this.indexCompaniesActives(),this.indexTypesActives()}},ce={class:"row"},ue=["value","selected"];function de(e,t,c,h,s,d){const A=i("Header"),x=i("Search"),C=i("BasicInput"),B=i("BasicSelect"),P=i("DefaultIconInput"),T=i("PrimaryIconBtn"),z=i("GrowingLoader"),w=i("BasicTable"),E=i("Report"),D=i("CreateMedicine"),V=i("Page");return m(),f(V,{Title:"",Links:[{path:"/admin/documents",name:e.$t("ImportDocuments"),status:!1},{path:"/",name:e.$t("RegistrationMedicines"),status:!0}]},{default:g(()=>[o("div",ce,[a(A,{document:s.document},null,8,["document"]),a(x,{isChange:s.change,onOnAdd:t[0]||(t[0]=r=>d.addItem(r))},null,8,["isChange"]),a(w,{Th:[e.$t("No"),e.$t("Picture"),e.$t("ModalName"),e.$t("ExpiryDateFinished"),e.$t("BoxSize"),e.$t("BuyPrice"),e.$t("Amount"),e.$t("Subtotal"),e.$t("Settings")],Title:"",Col:"col-lg-12"},{default:g(()=>[(m(!0),b(I,null,_(s.medicines,(r,u)=>(m(),b("tr",null,[o("td",null,p(u+1),1),o("td",null,[o("div",{class:"table_image",style:U("background-image: url("+r.image[0].url+")")},null,4)]),o("td",null,p(r.name)+" "+p(r.id),1),o("td",null,[a(C,{Label:"",Name:"date",Type:"date",Value:s.medicines[u].expiry_date_finished,Validated:this.dataErrors.includes("date"+r.sortId)?s.errors:"",onOnInput:n=>s.medicines[u].expiry_date_finished=n},null,8,["Value","Validated","onOnInput"])]),o("td",null,[a(B,{Label:"",Name:"size_type_id",onOnInput:n=>s.medicines[u].box_size_id=n},{default:g(()=>[(m(!0),b(I,null,_(s.boxSizes,n=>(m(),b("option",{value:n.id,selected:n.id==r.box_size_id},p(n.name),9,ue))),256))]),_:2},1032,["onOnInput"])]),o("td",null,[a(P,{Label:"",Name:"buy_price",Type:"text",Validated:this.dataErrors.includes("buy_price"+r.sortId)?s.errors:"",Value:h.counterStore.formatNumber(r.buy_price),onOnInput:n=>(d.changePrice(n,u),s.isChange=!s.isChange),inputClass:"medicinePrice"+u},{default:g(()=>[J(p(r.currency.sign),1)]),_:2},1032,["Validated","Value","onOnInput","inputClass"])]),o("td",null,[a(C,{Label:"",Name:"buy_amount",Validated:this.dataErrors.includes("buy_amount"+r.sortId)?s.errors:"",Type:"number",Value:r.buy_amount,onOnInput:n=>(s.medicines[u].buy_amount=n,s.isChange=!s.isChange)},null,8,["Validated","Value","onOnInput"])]),o("td",null,p(h.counterStore.formatNumber(Number(r.buy_price)*Number(r.buy_amount)))+" "+p(r.currency.sign),1),o("td",null,[h.counterStore.hasRole("Documents-update")?(m(),f(T,{key:0,onClick:n=>(s.change=r.id,s.medicines.splice(u,1),d.deleteError(r.sortId)),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):S("",!0)])]))),256)),s.loader?(m(),f(z,{key:0,Cols:"8"})):S("",!0)]),_:1},8,["Th"]),a(E,{onDataErrors:t[1]||(t[1]=r=>s.dataErrors=r),medicines:s.medicines,document:s.document,isChange:s.isChange},null,8,["medicines","document","isChange"])]),a(D,{crud:"create",medicineCategories:s.medicineCategories,boxSizes:s.boxSizes,drugCompanies:s.drugCompanies,sizeTypes:s.sizeTypes,onIndexCategoryActives:t[2]||(t[2]=r=>d.indexCategoryActives()),onIndexCompaniesActives:t[3]||(t[3]=r=>d.indexCompaniesActives()),onIndexBoxSizesActives:t[4]||(t[4]=r=>d.indexBoxSizesActives()),onIndexTypesActives:t[5]||(t[5]=r=>d.indexTypesActives()),mloader:s.mloader,onOnCreate:t[6]||(t[6]=()=>{})},null,8,["medicineCategories","boxSizes","drugCompanies","sizeTypes","mloader"])]),_:1},8,["Links"])}const ve=M(ae,[["render",de]]);export{ve as default};
