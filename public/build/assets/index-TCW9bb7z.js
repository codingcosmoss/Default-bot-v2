import{P as x}from"./Page--X10l4un.js";import{_ as f,o as m,c,a as r,s as k,t as u,n as _,v as P,u as E,x as L,A as v,y as I,z as g,B as C,r as h,b as l,f as y,h as b,F as N,w as O}from"./app-0LpGGDjw.js";import{I as R}from"./Input-31EGHoE1.js";import{I as j}from"./InputDefault-iSTsXjwG.js";import{I as A}from"./ImageInput-aVgN7gst.js";import{C as V}from"./Checkbox01-89eBkIYd.js";import{T as F}from"./Table-b9sujwcA.js";import"./Switch-IzpGzEfA.js";import"./CreateForm-TwO3_Ufm.js";import"./Select-vvngwYib.js";import"./Input-qRYOmpW5.js";import"./pagination-01.vue_vue_type_style_index_0_lang-dWoveVZW.js";import"./paginate-nhVISHLA.js";import"./InputText-xylaGTjy.js";import"./Select-RH5o7MjU.js";import"./Textarea-aoHlS1LH.js";import"./InputTime-SD-dlHVU.js";import"./Loader-iMOtN3gY.js";const S={components:{Input:j},props:{Couple:{type:Boolean,default:!0},Title:{type:String,default:"Checkbox title"}}};function T(e,s,t,d,o,i){return m(),c("li",null,[r("input",{type:"checkbox",onInput:s[0]||(s[0]=p=>this.$emit("onCheck",!0))},null,32),k(" Â  "+u(t.Title),1)])}const B=f(S,[["render",T],["__scopeId","data-v-1ce49b05"]]),q={props:{Couple:{type:Boolean,default:!0},Label:{type:String,default:"Input label"},Value:{type:[String,Boolean,Number],default:""},Type:{type:String,default:"text"},isError:{type:Boolean,default:!1}}},D={class:"mb-2.5 block text-black dark:text-white"},K=["value","type"];function z(e,s,t,d,o,i){return m(),c("div",{class:_(t.Couple?"mb-4.5":"w-full xl:w-1/2")},[r("label",D,u(t.Label),1),r("input",{value:t.Value,type:t.Type,class:_([t.isError==!0?"isError":"","rounded border-[1.5px] border-stroke bg-transparent py-20 px-2 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"]),placeholder:"Select subject",onInput:s[0]||(s[0]=p=>this.$emit("onInput",p.target.value)),style:{width:"80px",height:"40px"}},null,42,K)],2)}const H=f(q,[["render",z]]),J={data(){return{name:"",position:"",login:"",profil_photo_path:"",percent_salary:"",salary_static:"",isPasswordError:!1,password:"",reset_password:"",isLoginError:!1,color:"#FFFFFF",errorObj:{},image:"",photo:"",Roles:[],Permissions:[],PermissionsArr:[],Loader:!1}},components:{Table:F,Checkbox01:V,ImageInput:A,InputColor:H,Checkbox:B,Input:R},methods:{addRoles(e){this.Roles.includes(e)?(this.Roles=this.Roles.filter(s=>s!=e),this.PermissionsArr=this.PermissionsArr.filter(s=>s.role_id!=e)):this.Roles.push(e)},addAllRoles(){this.Roles.length!=16?(this.Roles=[],this.Permissions.forEach(e=>{this.Roles.push(e.id),console.log("Permission>",e.permissions),e.permissions.forEach(s=>{this.PermissionsArr.push({role_id:s.role_id,permission_id:s.id})})})):(this.Roles=[],this.PermissionsArr=[])},async getPermissions(){const e=await P();this.Permissions=e.data},hasPermission(e,s){let t=!1;return this.PermissionsArr.forEach(d=>{d.role_id==e&&d.permission_id==s&&(t=!0)}),!!t},getName(e){return E().getName(e)},testPassword(e){return this.password!=e?(this.isPasswordError=!0,this.Loader=!1):this.isPasswordError=!1,this.reset_password=e,this.isPasswordError},async update(){this.Loader=!0;var e={name:this.name,position:this.position,login:this.login,profil_photo_path:this.profil_photo_path,percent_salary:this.percent_salary,salary_static:this.salary_static,sort_order:this.sort_order,color:this.color,image:this.image,roles:this.Roles,permissions:this.PermissionsArr};const s=await L(this.$route.query.id,e);s.status?(localStorage.setItem("user",JSON.stringify(s.data)),v("success","Updated successfully !"),this.$router.push("/employees")):(console.log("data",s.data),this.errorObj=s.data,this.Loader=!1),this.Loader=!1},async updatePassword(){if(this.password!=null&&this.password.length>0){if(console.log("R 1",this.password),this.testPassword(this.reset_password)!=!0){var e={id:this.$route.query.id,password:this.password};const s=await I(e);s.status?this.update():(console.log(s.data),this.errorObj=s.data)}}else console.log("R 2"),this.update()},async sendData(){this.Loader=!0;const e=this.login;(await g({login:e,id:this.$route.query.id})).status?(this.isLoginError=!0,this.Loader=!1):(this.isLoginError=!1,this.updatePassword())},async get(){const e=await C(this.$route.query.id),s=e.data;console.log(s),e.status?(this.name=s.name,this.position=s.position,this.login=s.login,this.password=s.password,this.profil_photo_path=s.profil_photo_path,this.percent_salary=s.percent_salary,this.salary_static=s.salary_static,this.sort_order=s.sort_order,this.photo=s.image[0].url,s.roles.forEach(t=>{this.Roles.push(t.id)}),s.permissions.length>0&&s.permissions.forEach(t=>{this.PermissionsArr.push({role_id:t.role_id,permission_id:t.permission_id})}),this.color=s.color==null?"#ffffff":s.color):(console.log("data:",e.data),this.errorObj=e.data)},async testLogin(e){this.login=e,(await g({login:e,id:this.$route.query.id})).status?this.isLoginError=!0:this.isLoginError=!1},hasKey(e){return e in this.errorObj},addPermission(e,s){this.hasPermission(e,s)?this.PermissionsArr=this.PermissionsArr.filter(t=>!(t.role_id==e&&t.permission_id==s)):this.PermissionsArr.push({role_id:e,permission_id:s})}},mounted(){this.get(),this.getPermissions()}},U={class:"breadcrumb-nav mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},G={class:"flex items-center gap-2"},M={class:"font-medium text-primary"},Q={class:"grid grid-cols-1 gap-9 sm:grid-cols-2"},W={class:"flex flex-col gap-9"},X={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},Y={class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},Z={class:"font-semibold text-black dark:text-white"},$={action:"#"},ss={class:"p-6.5"},es={class:"flex flex-col gap-9"},rs={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},os=r("div",{class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},[r("h3",{class:"font-semibold text-black dark:text-white"})],-1),ts={action:"#"},is={class:"p-6.5"},as={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ns={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ls={class:"pl-7 p-6.5",style:{display:"flex","justify-content":"center"}};function ds(e,s,t,d,o,i){const p=h("ImageInput"),n=h("Input"),w=h("loader-spinning");return m(),c(N,null,[r("div",U,[r("nav",null,[r("ol",G,[r("li",null,[r("a",{class:"font-medium cursor-pointer",onClick:s[0]||(s[0]=a=>this.$router.push("/"))},u(i.getName("Home"))+" /",1)]),r("li",M,u(i.getName("update")),1)])])]),r("div",Q,[r("div",W,[r("div",X,[r("div",Y,[r("h3",Z,u(i.getName("add_employee")),1)]),r("form",$,[r("div",ss,[l(p,{onImage:s[1]||(s[1]=a=>o.image=a),Photo:o.photo,Label:"Photo"},null,8,["Photo"])])])])]),r("div",es,[r("div",rs,[os,r("form",ts,[r("div",is,[r("div",as,[l(n,{Couple:!1,Label:i.getName("employee_name"),onOnInput:s[2]||(s[2]=a=>o.name=a),isError:i.hasKey("name"),message:o.errorObj.name,Value:o.name},null,8,["Label","isError","message","Value"]),l(n,{Couple:!1,Label:i.getName("Position_employee"),onOnInput:s[3]||(s[3]=a=>o.position=a),isError:i.hasKey("position"),message:o.errorObj.position,Value:o.position},null,8,["Label","isError","message","Value"])]),l(n,{Label:i.getName("login"),onOnInput:s[4]||(s[4]=a=>i.testLogin(a)),Value:o.login,isError:o.isLoginError||o.errorObj.login,message:o.errorObj.login?o.errorObj.login:"Login is available !"},null,8,["Label","Value","isError","message"]),r("div",ns,[l(n,{Couple:!1,Label:i.getName("password"),onOnInput:s[5]||(s[5]=a=>o.password=a),Type:"password",isError:i.hasKey("password"),message:o.errorObj.password},null,8,["Label","isError","message"]),l(n,{Couple:!1,Label:i.getName("reset_password"),onOnInput:s[6]||(s[6]=a=>i.testPassword(a)),isError:o.isPasswordError,Type:"password",Value:o.reset_password,message:"The password is not the same"},null,8,["Label","isError","Value"])])])]),r("div",ls,[o.Loader?(m(),y(w,{key:0,style:{margin:"0 auto"}})):b("",!0),o.Loader?b("",!0):(m(),c("button",{key:1,onClick:s[7]||(s[7]=(...a)=>i.sendData&&i.sendData(...a)),class:"flex w-full justify-center rounded bg-primary p-3 font-medium text-gray"},u(i.getName("Save")),1))])])])])],64)}const ps=f(J,[["render",ds]]),us={components:{CreateForm:ps,Page:x}};function ms(e,s,t,d,o,i){const p=h("CreateForm"),n=h("Page");return m(),y(n,{Classes:!1},{default:O(()=>[l(p)]),_:1})}const Rs=f(us,[["render",ms]]);export{Rs as default};
