import{_ as y,u as I,o as r,c as l,a,t as n,n as h,g as m,h as S,A as b,bs as P,l as B,br as k,e as _,w as p,b as g,F as C,f as V,r as f,bt as D,bu as T,d as A,I as M}from"./app-qjkFfopU.js";import{a as $}from"./BasicTable-DVjjvWl8.js";import{a as x}from"./Page-6po4WWvc.js";import{D as L}from"./DefaultInput-qAxpax30.js";import{D as j}from"./DefaultSelect-QS9w35hK.js";import{G as E}from"./GrowingLoader-C9t3ZqrR.js";const O={setup(){return{counterStore:I()}},props:{document:{type:[Array,Object],default:[]}}},z={class:"col-xl-12"},F={class:"card"},G={class:"card-body"},H={class:"table-responsive"},R={class:"table table-bordered mb-0"},q={key:0};function W(t,s,e,i,o,u){return r(),l("div",z,[a("div",F,[a("div",G,[a("div",H,[a("table",R,[a("thead",null,[a("tr",null,[a("th",null,n(t.$t("Id")),1),a("th",null,n(t.$t("Warehouse")),1),a("th",null,n(t.$t("Supplier")),1),a("th",null,n(t.$t("ImportedDate")),1),a("th",null,n(t.$t("Subtotal")),1),a("th",null,n(t.$t("AmountPaid")),1),a("th",null,n(t.$t("Indebtedness")),1),a("th",null,n(t.$t("Status")),1)])]),a("tbody",null,[e.document.length!=0?(r(),l("tr",q,[a("td",null," #"+n(e.document.id),1),a("td",null,n(e.document.warehouse.name),1),a("td",null,n(e.document.supplier.name),1),a("td",null,n(e.document.date),1),a("td",null,n(i.counterStore.formatNumber(e.document.subtotal))+" "+n(e.document.currency.sign),1),a("td",null,n(i.counterStore.formatNumber(e.document.amount_paid))+" "+n(e.document.currency.sign),1),a("td",null,n(i.counterStore.formatNumber(e.document.loan_amount))+" "+n(e.document.currency.sign),1),a("td",null,[a("span",{class:h([e.document.status==5?"badge-soft-success":"badge-soft-warning","badge badge-pill font-size-11"])},n(e.document.status==5?t.$t("Saved"):t.$t("NotSaved")),3)])])):m("",!0)])])])])])])}const Qe=y(O,[["render",W]]),J={props:{Class:{type:String,default:"col-lg-12 col-sm-12"},inputClass:{type:String,default:""},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},K={key:0,class:"form-label"},Q={class:"input-group",id:"timepicker-input-group1"},U=["type","value","placeholder"],X={class:"input-group-text"};function Y(t,s,e,i,o,u){return r(),l("div",{class:h(e.Class)},[a("div",null,[e.Label!=""?(r(),l("label",K,n(e.Label),1)):m("",!0),a("div",Q,[a("input",{class:h(["form-control",e.Validated[e.Name]?"border-danger "+e.inputClass:e.inputClass]),type:e.Type,value:e.Value,placeholder:e.Pholder,onInput:s[0]||(s[0]=c=>this.$emit("onInput",c.target.value))},null,42,U),a("span",X,[S(t.$slots,"default")])])])],2)}const Z=y(J,[["render",Y]]),ee={components:{DefaultSelect:j,DefaultIconInput:Z,DefaultInput:L,PrimaryBtn:x,BtnBox:$},setup(){return{counterStore:I()}},props:{medicines:[Object,Array],document:[Object,Array],isChange:Boolean},data(){return{subtotal:0,errors:[],loader:!1,paid:0,paymentTypes:[],payment_type_id:null,dataErrors:[]}},methods:{validator(){let t=[];return this.medicines.forEach((s,e)=>{(s.expiry_date_finished==null||this.isDateBeforeToday(s.expiry_date_finished))&&t.push("date"+s.sortId),this.isNumber(s.buy_price)||t.push("buy_price"+s.sortId),(!this.isNumber(s.buy_amount)||s.buy_amount<=0)&&t.push("buy_amount"+s.sortId)}),this.dataErrors=t,t.length>0||this.medicines==[]?(b("error",this.$t("formError")),!1):this.paid>this.subtotal?(b("error",this.$t("TheIncreased")),!1):this.paid>0&&this.payment_type_id<1?(b("error",this.$t("PaymentTyperequired")),!1):!0},isNumber(t){const s=parseFloat(t);return!isNaN(s)&&typeof s=="number"},isDateBeforeToday(t){const s=new Date(t),e=new Date;return e.setHours(0,0,0,0),s.setHours(0,0,0,0),s<e},async save(){try{if(this.loader=!0,!this.validator())return this.$emit("dataErrors",this.dataErrors),this.loader=!1,!1;let t={document_id:this.document.id,supplier_id:this.document.supplier_id,warehouse_id:this.document.warehouse_id,payment_type_id:this.payment_type_id,amount_paid:this.paid,medicines:this.medicines,currency_id:this.counterStore.user.currency.id};console.log("Data:",t);const s=await P(t);return s.status?(b("success",this.$t("save")),this.loader=!1,this.$router.push("/admin/documents"),!0):(this.errors=s.errors,b("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return B(this,t),this.loader=!1,!1}},report(){let t=0;this.medicines.forEach(s=>{t+=s.buy_price*s.buy_amount}),this.subtotal=t},addPrice(t){let s=this.counterStore.inputNumberFormat("reportPrice",this.paid,t);this.paid=s},async indexPaymentTypes(){try{this.loader=!0;const t=await k();this.paymentTypes=t.data,this.loader=!1}catch(t){B(this,t)}}},watch:{isChange:function(t,s){this.report()}},mounted(){this.indexPaymentTypes()}},te={class:"w-100 d-flex justify-content-end"},ae={class:"col-xl-5"},se={class:"card"},ne={class:"card-body"},re={class:"table-responsive"},le={class:"table table-nowrap mb-0"},oe={scope:"row"},ie={scope:"row"},de={scope:"row"},ue={scope:"row"},ce=a("option",{selected:"",value:0},"---",-1),me=["value"],he=a("br",null,null,-1);function fe(t,s,e,i,o,u){const c=f("DefaultIconInput"),v=f("DefaultSelect"),N=f("PrimaryBtn"),w=f("BtnBox");return r(),l("div",te,[a("div",ae,[a("div",se,[a("div",ne,[a("div",re,[a("table",le,[a("tbody",null,[a("tr",null,[a("th",oe,n(t.$t("Subtotal"))+" :",1),a("td",null,n(i.counterStore.formatNumber(o.subtotal))+" "+n(i.counterStore.user.currency.sign),1)]),a("tr",null,[a("th",ie,n(t.$t("AmountToPaid"))+" :",1),a("td",null,n(i.counterStore.formatNumber(o.subtotal))+" "+n(i.counterStore.user.currency.sign),1)]),a("tr",null,[a("th",de,n(t.$t("Paid"))+" :",1),a("td",null,[_(c,{DefaultIconInput:"",Label:"",Name:"amount_paid",Type:"text",Validated:o.errors,onOnInput:s[0]||(s[0]=d=>(u.addPrice(d),delete this.errors.amount_paid)),inputClass:"reportPrice",Value:i.counterStore.formatNumber(o.paid)},{default:p(()=>[g(n(i.counterStore.user.currency.sign),1)]),_:1},8,["Validated","Value"])])]),a("tr",null,[a("th",ue,n(t.$t("PaymentType"))+" :",1),a("td",null,[_(v,{Label:"",Name:"payment_type_id",Validated:o.errors,Value:o.payment_type_id,onOnInput:s[1]||(s[1]=d=>(o.payment_type_id=d,delete this.errors.payment_type_id))},{default:p(()=>[ce,(r(!0),l(C,null,V(o.paymentTypes,d=>(r(),l("option",{value:d.id},n(d.name),9,me))),256))]),_:1},8,["Validated","Value"])])])])])]),he,_(w,null,{default:p(()=>[_(N,{Loader:o.loader,onClick:s[2]||(s[2]=d=>u.save())},{default:p(()=>[g(n(t.$t("Save")),1)]),_:1},8,["Loader"])]),_:1})])])])])}const Ue=y(ee,[["render",fe]]),_e={components:{GrowingLoader:E,BtnBox:$,BaseBox:D,DefaultInput:L,PrimaryBtn:x},props:{tableMedicines:Object,isChange:Object},watch:{isChange:function(t,s){console.log("oke",this.tableMedicines),this.medicines=this.medicines.filter(e=>e.id!=this.isChange)}},setup(){return{counterStore:I()}},data(){return{items:[],loader:!1,medicines:[]}},methods:{hasMedicines(t){return!!this.medicines.find(e=>e.id==t.id)},addMedicines(t){this.medicines.push(t),this.$emit("onAdd",t)},async search(t=""){try{this.loader=!0;const s=await T(t);return this.items=s.data,this.loader=!1,s.status?(this.loader=!1,!0):(Alert("error",this.$t("formError")),this.loader=!1,!1)}catch(s){return B(this,s),this.loader=!1,!1}}}},ye={class:"w-100 d-flex mb-2"},pe={class:"col-5",style:{"z-index":"100"}},be={class:"dropdown"},ge={class:"dropdown-menu col-lg-12 col-sm-12","aria-labelledby":"dropdownMenuButton",style:{"z-index":"1000"}},Se=["onClick"],ve={class:"d-flex justify-content-center flex-column search_item"},Ne={class:"search_p"},we={class:"search_p_2"},Be={key:0,class:"dropdown-item d-flex justify-content-center"};function Ie(t,s,e,i,o,u){const c=f("DefaultInput"),v=f("GrowingLoader"),N=f("PrimaryBtn"),w=f("BtnBox");return r(),l("div",ye,[a("div",pe,[a("div",be,[_(c,{id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",Class:"col-lg-12 col-sm-12   search_input",Label:"",Name:"name",Type:"text",Pholder:t.$t("SearchMedicines"),onOnInput:s[0]||(s[0]=d=>u.search(d))},null,8,["Pholder"]),a("div",ge,[(r(!0),l(C,null,V(o.items,d=>(r(),l("a",{class:h(["dropdown-item d-flex align-items-center",u.hasMedicines(d)?"bg-success-subtle":""]),onClick:Ge=>u.addMedicines(d)},[a("div",{class:"table_image search_medicines_img",style:M("background-image: url("+d.image[0].url+")")},null,4),a("div",ve,[a("p",Ne,n(d.name)+" ("+n(d.drug_company)+")",1),a("p",we,n(d.generic_name),1)])],10,Se))),256)),o.loader?(r(),l("a",Be,[_(v)])):m("",!0)])])]),_(w,null,{default:p(()=>[i.counterStore.hasRole("Medicines-create")?(r(),A(N,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#medicineCreate"},{default:p(()=>[g(n(t.$t("CreateMedicine")),1)]),_:1})):m("",!0)]),_:1})])}const Xe=y(_e,[["render",Ie]]),Ce={props:{isButton:{type:Boolean,default:!1},Class:{type:String,default:"col-lg-12 col-sm-12"},ModalName:{type:String,default:"modal"},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},Ve={key:0,class:"form-label"},$e=["data-bs-target"],xe={class:"input-group",id:"timepicker-input-group1"},Le={class:"input-group-text"},Pe={key:1,class:"form-label text-danger"};function ke(t,s,e,i,o,u){return r(),l("div",{class:h(e.Class)},[a("div",null,[e.Label!=""?(r(),l("label",Ve,[g(n(e.Label)+" ",1),e.isButton?(r(),l("a",{key:0,class:"btn btn-primary waves-effect waves-light",role:"button","data-bs-toggle":"modal","data-bs-target":"#"+e.ModalName,style:{padding:"0px 5px","font-size":"10px"}},n(t.$t("Create")),9,$e)):m("",!0)])):m("",!0),a("div",xe,[a("select",{class:h(["form-select",e.Validated[e.Name]?"border-danger":""]),onInput:s[0]||(s[0]=c=>this.$emit("onInput",c.target.value))},[S(t.$slots,"default")],34),a("span",Le,[S(t.$slots,"icon")])]),e.Validated[e.Name]?(r(),l("p",Pe,n(e.Validated[e.Name]),1)):m("",!0)])],2)}const Ye=y(Ce,[["render",ke]]),De={props:{Class:{type:String,default:"col-lg-12 col-sm-12"},inputClass:{type:String,default:""},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},Te={key:0,class:"form-label"},Ae=["type","value","placeholder"];function Me(t,s,e,i,o,u){return r(),l("div",{class:h(e.Class)},[a("div",null,[e.Label!=""?(r(),l("label",Te,n(e.Label),1)):m("",!0),a("input",{class:h(["form-control",e.Validated[e.Name]?"border-danger "+e.inputClass:e.inputClass]),type:e.Type,value:e.Value,placeholder:e.Pholder,onInput:s[0]||(s[0]=c=>this.$emit("onInput",c.target.value))},null,42,Ae)])],2)}const Ze=y(De,[["render",Me]]),je={props:{isButton:{type:Boolean,default:!1},Class:{type:String,default:"col-lg-12 col-sm-12"},ModalName:{type:String,default:"modal"},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},Ee={key:0,class:"form-label"},Oe=["data-bs-target"],ze={key:1,class:"form-label text-danger"};function Fe(t,s,e,i,o,u){return r(),l("div",{class:h(e.Class)},[a("div",null,[e.Label!=""?(r(),l("label",Ee,[g(n(e.Label)+" ",1),e.isButton?(r(),l("a",{key:0,class:"btn btn-primary waves-effect waves-light",role:"button","data-bs-toggle":"modal","data-bs-target":"#"+e.ModalName,style:{padding:"0px 5px","font-size":"10px"}},n(t.$t("Create")),9,Oe)):m("",!0)])):m("",!0),a("select",{class:h(["form-select",e.Validated[e.Name]?"border-danger":""]),onInput:s[0]||(s[0]=c=>this.$emit("onInput",c.target.value))},[S(t.$slots,"default")],34),e.Validated[e.Name]?(r(),l("p",ze,n(e.Validated[e.Name]),1)):m("",!0)])],2)}const et=y(je,[["render",Fe]]);export{et as B,Z as D,Qe as H,Ye as I,Ue as R,Xe as S,Ze as a};
