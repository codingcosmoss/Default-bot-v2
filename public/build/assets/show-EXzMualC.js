import{a as I,M as D,b as A,P as L}from"./Page-X_CL2XrS.js";import{_ as N,u as U,ar as G,a9 as O,l as r,aa as V,A as o,ab as q,ac as M,ad as R,ae as F,af as j,ag as z,ah as H,at as J,aj as K,ak as Q,d as u,w as p,r as i,o as n,a,c as y,f as b,F as w,e as m,b as C,t as c,g}from"./app-HuQxhYkh.js";import{B as W}from"./BasicTable-yOAfWnez.js";import{P as X,G as Y}from"./GrowingLoader-hxei4TSu.js";import{U as Z,C as ee}from"./create-HBIDIkui.js";import{D as te}from"./DefaultInput-8EaRomtX.js";import{P as se}from"./Paginate-a87pEyqc.js";import{D as ae}from"./DefaultSelect-6fsBvJhD.js";import{C as re}from"./CardBlock-zWIgrFGz.js";import"./ImageInput-2jWvBMRc.js";const ne={components:{CardBlock:re,DefaultSelect:ae,Paginate:se,DefaultInput:te,PrimaryBtn:I,ModalCentered:D,PrimaryIconBtn:X,PrimaryButton:A,GrowingLoader:Y,BasicTable:W,Page:L,Update:Z,Create:ee},setup(){return{counterStore:U()}},data(){return{items:[],item:[],headers:[1,2,3,4,5,6],paginateCount:10,last_page:1,current_page:1,column:"id",type:"desc",errors:[],loader:!1,totals:[],categories:[],text:""}},methods:{expense_categorySearch(){return G},async index(){try{const e=await O();this.items=e.data}catch(e){r(this,e)}},async indexCategories(){try{const e=await V();this.categories=e.data}catch(e){r(this,e)}},async getCurrencies(e){try{if(this.loader=!0,e==0){this.indexPaginates(1),o("info",this.$t("currenciesAlert"));return}const t=await q(e);this.loader=!1,this.items=t.data,o("info",this.$t("currenciesAlert"))}catch(t){r(this,t)}},async getTotals(){try{const e=await M();let t=0;e.data.forEach(l=>{t+=l.total_amount});let f=e.data;f.push({title:"Sum",sign:"",currency_id:0,total_amount:t}),this.totals=f}catch(e){r(this,e)}},async indexPaginates(e=1){try{this.loader=!0;const t=await R(this.paginateCount,e);this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items,this.item=t.data.items[0],this.loader=!1}catch(t){r(this,t)}},async orderBys(){try{const e=await F(this.column,this.type);this.items=e.data}catch(e){r(this,e)}},async show(e){try{const t=await j(e);this.item=t.data}catch(t){r(this,t)}},async create(){try{const t=await z({});return t.status?(o("success",this.$t("create")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return r(this,e),!1}},async update(){try{const t=await H({});return t.status?(o("success",this.$t("update")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return r(this,e),!1}},async search(e=""){try{if(this.loader=!0,e=="")return this.getCategoryExpensies(),!0;this.text=e;const t=await J(this.$route.query.id,e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(o("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return r(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;const t=await K(e);return this.items=t.data,t.status&&(o("success",this.$t("delete")),this.getCategoryExpensies(this.current_page)),o("error",this.$t("formError")),!1}catch(t){return r(this,t),!1}},async getCategoryExpensies(e=1){try{this.loader=!0;const t=await Q(this.$route.query.id,e);this.loader=!1,this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items}catch(t){r(this,t)}}},mounted(){this.getCategoryExpensies()}},oe={class:"row"},ie=["onClick"],ce={class:"card mini-stats-wid"},le={class:"card-body"},ue={class:"d-flex flex-wrap"},de={class:"me-3"},he={class:"text-muted mb-2"},pe={class:"mb-0"},me=a("div",{class:"avatar-sm ms-auto"},[a("div",{class:"avatar-title bg-light rounded-circle text-primary font-size-20"},[a("i",{class:"bx bx-money"})])],-1),ge=a("tr",null,null,-1);function ye(e,t,f,l,d,h){const P=i("DefaultInput"),E=i("PrimaryBtn"),_=i("PrimaryIconBtn"),k=i("Paginate"),$=i("GrowingLoader"),B=i("BasicTable"),S=i("Update"),v=i("Create"),T=i("Page");return n(),u(T,{Title:"",Links:[{path:"/admin/expense/categories",name:e.$t("ExpenseCategories"),status:!1},{name:e.$t("Expenses"),status:!0}]},{default:p(()=>[a("div",oe,[(n(!0),y(w,null,b(d.totals,s=>(n(),y("div",{onClick:x=>h.getCurrencies(s.currency_id),class:"col-lg-3 cursor-pointer"},[a("div",ce,[a("div",le,[a("div",ue,[a("div",de,[a("p",he,c(s.title=="Sum"?e.$t("Total"):s.title),1),a("h5",pe,c(l.counterStore.formatNumber(s.total_amount))+" "+c(s.sign),1)]),me])])])],8,ie))),256)),m(B,{Th:[e.$t("Id"),e.$t("Title"),e.$t("Amount"),e.$t("Date"),e.$t("ExpensesCategory"),e.$t("Settings")],Title:e.$t("Expenses"),Col:"col-lg-12"},{inputs:p(()=>[m(P,{Class:"col-lg-3 col-sm-2 search_input",Label:"",Name:"name",Type:"text",Pholder:"Search...",onOnInput:t[0]||(t[0]=s=>h.search(s))})]),buttons:p(()=>[l.counterStore.hasRole("Expenses-create")?(n(),u(E,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#expenseCreate"},{default:p(()=>[C(c(e.$t("Create")),1)]),_:1})):g("",!0)]),default:p(()=>[(n(!0),y(w,null,b(d.items,s=>(n(),y("tr",null,[a("td",null," #"+c(s.id),1),a("td",null,c(s.title),1),a("td",null,c(l.counterStore.formatNumber(s.amount)+" "+s.currency.sign),1),a("td",null,c(s.date),1),a("td",null,c(s.category),1),a("td",null,[l.counterStore.hasRole("Expenses-update")?(n(),u(_,{key:0,onClick:x=>this.item=s,Icon:"bx bx-edit-alt",Modal:"expenseUpdate"},null,8,["onClick"])):g("",!0),C("  "),m(_,{onClick:x=>this.$router.push({path:"/admin/expenses/show",query:{id:s.id}}),Icon:"bx bx-show"},null,8,["onClick"]),C("  "),l.counterStore.hasRole("Expenses-delete")?(n(),u(_,{key:1,onClick:x=>this.delete(s.id),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):g("",!0)])]))),256)),d.last_page!=1?(n(),u(k,{key:0,currentPage:this.current_page,totalPages:this.last_page,onChangePage:t[1]||(t[1]=s=>h.getCategoryExpensies(s))},null,8,["currentPage","totalPages"])):g("",!0),d.loader?(n(),u($,{key:1,Cols:"7"})):g("",!0),ge]),_:1},8,["Th","Title"])]),m(S,{Item:d.item,onOnUpdate:t[2]||(t[2]=s=>h.getCategoryExpensies(this.current_page))},null,8,["Item"]),m(v,{onOnCreate:t[3]||(t[3]=s=>h.getCategoryExpensies(this.current_page))})]),_:1},8,["Links"])}const Be=N(ne,[["render",ye]]);export{Be as default};
