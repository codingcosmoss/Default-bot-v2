import{a as w,M as $,b as v,P as C}from"./Page-6po4WWvc.js";import{_ as S,o as l,c as y,h as H,p as R,k as j,a as t,u as M,bo as q,A as m,l as h,d as f,w as c,e as u,b as D,t as r,f as L,F as N,r as a,bp as z,bq as U,br as J,g as T,I as K}from"./app-qjkFfopU.js";import{a as Q,B as W}from"./BasicTable-DVjjvWl8.js";import{P as X,G as Y}from"./GrowingLoader-C9t3ZqrR.js";import{D as V}from"./DefaultInput-qAxpax30.js";import{P as Z}from"./Paginate-pkoQmS0i.js";import{D as E}from"./DefaultSelect-QS9w35hK.js";import{D as k,B as ee,a as te,I as oe,H as re,R as se,S as ae}from"./BasicSelect-q1jJDiaA.js";import{U as ne,C as B}from"./create-RuiXONc6.js";import{I as ie}from"./ImageInput-rzGOIOcx.js";import"./boxCreate-_Z9U-oaD.js";import"./boxCreate-aQ7xexVm.js";const le={props:{Loader:{type:Boolean,default:!1},Modal:{type:String,default:"modal"}}},de=e=>(R("data-v-5e430008"),e=e(),j(),e),ue=["disabled","data-bs-target"],ce={key:1,class:"spinner-border text-white m-1",role:"status"},me=de(()=>t("span",{class:"sr-only"},"Loading...",-1)),pe=[me];function he(e,o,p,i,s,_){return l(),y("button",{disabled:p.Loader,type:"button","data-bs-toggle":"modal","data-bs-target":"#"+p.Modal,class:"btn btn-primary w-md"},[p.Loader?(l(),y("div",ce,pe)):H(e.$slots,"default",{key:0},void 0,!0)],8,ue)}const ye=S(le,[["render",he],["__scopeId","data-v-5e430008"]]),_e={components:{DefaultIconInput:k,DefaultSelect:E,PrimaryBtn:w,BtnBox:Q,ModalCentered:$,ImageInput:ie,PrimaryButton:v,DefaultInput:V,Page:C},setup(){return{counterStore:M()}},props:{Item:Object,paymentTypes:{type:[Object,Array],default:[]}},data(){return{items:[],item:[],paginateCount:10,column:"id",type:"desc",errors:[],passwordErrors:[],loader:!1,loaderPass:!1,payment_type_id:null,document_id:null,currency_id:null,paid:0,sign:""}},methods:{async toPay(){try{if(this.loader=!0,!this.vatidator()){this.loader=!1;return}let e={payment_type_id:this.payment_type_id,amount:this.paid,supplier_id:this.Item.supplier_id,document_id:this.document_id,currency_id:this.currency_id};console.log("Data:",e);const o=await q(e);return o.status?(this.$emit("onPayment",!0),this.counterStore.hiddenModal("documentToPayModal"),this.discharge(),m("success",this.$t("save")),this.loader=!1,!0):(this.errors=o.errors,m("error",this.$t("formError")),this.loader=!1,!1)}catch(e){return h(this,e),this.loader=!1,!1}},vatidator(){return this.paid==0?(this.errors.amount=this.$t("EnterPaymentAmount"),m("error",this.$t("EnterPaymentAmount")),!1):this.paid>this.Item.loan_amount?(this.errors.amount=this.$t("TheIncreased"),m("error",this.$t("TheIncreased")),!1):(this.errors.amount="",!0)},async save(){this.sign=this.counterStore.user.currency.sign,this.currency_id=this.counterStore.user.currency.id,this.item=this.Item,this.document_id=this.Item.id},discharge(){this.item="",this.document_id=null,this.currency_id=null,this.paid=0,this.errors=[]},addPrice(e){let o=this.counterStore.inputNumberFormat("reportPrice",this.paid,e);this.paid=o}},mounted(){this.discharge()},watch:{Item:function(e,o){this.save()}}},fe={class:"row"},be=t("p",{class:"form-label text-danger"},null,-1),ge=t("option",{selected:""},"---",-1),Pe=["value"];function Ie(e,o,p,i,s,_){const b=a("DefaultIconInput"),g=a("DefaultSelect"),P=a("BaseBox"),I=a("ModalCentered");return l(),f(I,{Title:e.$t("ToPay"),ModalName:"documentToPayModal",onOnModal:o[2]||(o[2]=d=>_.toPay())},{default:c(()=>[t("div",fe,[u(P,{Col:"col-xl-12",Title:""},{default:c(()=>[u(b,{DefaultIconInput:"",Label:e.$t("Amount"),Name:"amount",Type:"text",Validated:s.errors,onOnInput:o[0]||(o[0]=d=>(_.addPrice(d),delete this.errors.amount)),inputClass:"reportPrice",Value:i.counterStore.formatNumber(s.paid)},{default:c(()=>[D(r(s.sign),1)]),_:1},8,["Label","Validated","Value"]),be,u(g,{Label:e.$t("PaymentType"),Name:"payment_type_id",Validated:s.errors,Value:s.payment_type_id,onOnInput:o[1]||(o[1]=d=>(s.payment_type_id=d,delete this.errors.payment_type_id))},{default:c(()=>[ge,(l(!0),y(N,null,L(p.paymentTypes,d=>(l(),y("option",{value:d.id},r(d.name),9,Pe))),256))]),_:1},8,["Label","Validated","Value"])]),_:1})])]),_:1},8,["Title"])}const Se=S(_e,[["render",Ie]]),Te={components:{toPay:Se,PrimaryModalBtn:ye,BasicSelect:ee,BasicInput:te,IconSelect:oe,DefaultIconInput:k,Update:ne,Create:B,DefaultSelect:E,Paginate:Z,DefaultInput:V,PrimaryBtn:w,ModalCentered:$,PrimaryIconBtn:X,PrimaryButton:v,GrowingLoader:Y,BasicTable:W,Page:C,Header:re,Report:se,Search:ae,CreateMedicine:B},setup(){return{counterStore:M()}},data(){return{change:!1,isChange:!1,items:[],mloader:!1,item:[],boxItem:[],paginateCount:10,last_page:1,current_page:1,boxLast_page:1,boxCurrent_page:1,column:"id",type:"desc",loader:!1,boxLoader:!1,boxItems:[],medicines:[],document:[],sortId:1,paymentTypes:[]}},methods:{deleteError(e){this.isChange=!this.isChange,this.dataErrors=this.dataErrors.filter(o=>o!="date"+e&&o!="buy_price"+e&&o!="bu_amount"+e)},async show(){try{this.loader=!0;const e=await z(this.$route.query.id);this.medicines=e.data,this.loader=!1}catch(e){h(this,e)}},async showDocument(){try{const e=await U(this.$route.query.id);this.document=e.data}catch(e){h(this,e)}},async indexPaymentTypes(){try{this.loader=!0;const e=await J();this.paymentTypes=e.data,this.loader=!1}catch(e){h(this,e)}},async search(e=""){try{if(this.loader=!0,e=="")return this.indexPaginates(),!0;const o=await documentSearch(e);return this.items=o.data,this.loader=!1,o.status?(this.loader=!1,!0):(m("error",this.$t("formError")),this.loader=!1,!1)}catch(o){return h(this,o),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;if((await documentDelete(e)).status){this.indexPaginates(this.current_page),m("success",this.$t("delete"));return}return m("error",this.$t("formError")),!1}catch(o){return h(this,o),!1}}},mounted(){this.show(),this.showDocument(),this.indexPaymentTypes()}},Be={class:"row"},we={class:"w-100 d-flex justify-content-end"},$e={class:"col-xl-5"},ve={class:"card"},Ce={class:"card-body"},Me={class:"table-responsive"},De={class:"table table-nowrap mb-0"},Le={scope:"row"},Ne={scope:"row"},Ve=t("br",null,null,-1);function Ee(e,o,p,i,s,_){const b=a("Header"),g=a("PrimaryIconBtn"),P=a("GrowingLoader"),I=a("BasicTable"),d=a("ToPay"),x=a("PrimaryModalBtn"),A=a("BtnBox"),O=a("toPay"),F=a("Page");return l(),f(F,{Title:e.$t("RegistrationImportedDrugs"),Links:[{path:"/admin/documents",name:e.$t("ImportDocuments"),status:!1},{path:"/",name:e.$t("RegistrationMedicines"),status:!0}]},{default:c(()=>[t("div",Be,[u(b,{document:s.document},null,8,["document"]),u(I,{Th:[e.$t("No"),e.$t("Picture"),e.$t("ModalName"),e.$t("ExpiryDateFinished"),e.$t("BoxSize"),e.$t("BuyPrice"),e.$t("PurchasedAmount"),e.$t("CurrentAmount"),e.$t("Subtotal"),e.$t("Settings")],Title:"",Col:"col-lg-12"},{default:c(()=>[(l(!0),y(N,null,L(s.medicines,(n,G)=>(l(),y("tr",null,[t("td",null,r(G+1),1),t("td",null,[t("div",{class:"table_image",style:K("background-image: url("+n.medicine.image[0].url+")")},null,4)]),t("td",null,r(n.medicine.name)+" "+r(n.id),1),t("td",null,r(n.expiry_date_finished),1),t("td",null,r(n.box_size.name),1),t("td",null,r(i.counterStore.formatNumber(n.buy_price))+" "+r(n.currency.sign),1),t("td",null,r(i.counterStore.formatNumber(n.amount)),1),t("td",null,r(i.counterStore.formatNumber(n.current_amount)),1),t("td",null,r(i.counterStore.formatNumber(n.total_cost))+" "+r(n.currency.sign),1),t("td",null,[u(g,{Modal:"documentToPayModal",title:e.$t("UploadMedicine"),Icon:"bx bx-upload"},null,8,["title"])])]))),256)),s.loader?(l(),f(P,{key:0,Cols:"10"})):T("",!0)]),_:1},8,["Th"]),u(d),t("div",we,[t("div",$e,[t("div",ve,[t("div",Ce,[t("div",Me,[t("table",De,[t("tbody",null,[t("tr",null,[t("th",Le,r(e.$t("Subtotal"))+" :",1),t("td",null,r(i.counterStore.formatNumber(s.document.subtotal))+" "+r(i.counterStore.user.currency.sign),1)]),t("tr",null,[t("th",Ne,r(e.$t("AmountToPaid"))+" :",1),t("td",null,r(i.counterStore.formatNumber(s.document.loan_amount))+" "+r(i.counterStore.user.currency.sign),1)])])])]),Ve,u(A,null,{default:c(()=>[s.document.loan_amount>0?(l(),f(x,{key:0,Modal:"documentToPayModal",Loader:s.loader},{default:c(()=>[D(r(e.$t("ToPay")),1)]),_:1},8,["Loader"])):T("",!0)]),_:1})])])])])]),u(O,{Item:s.document,onOnPayment:o[0]||(o[0]=n=>_.showDocument()),paymentTypes:s.paymentTypes},null,8,["Item","paymentTypes"])]),_:1},8,["Title","Links"])}const Je=S(Te,[["render",Ee]]);export{Je as default};
