import{a as N,M as L,b as O,P as k}from"./Page-kS-htxF1.js";import{_ as M,u as R,br as F,A as y,l as d,b2 as G,b3 as H,b4 as j,b5 as q,d as b,w as g,r as i,o as m,a as n,e as a,c as f,f as C,t as p,I as U,F as I,b as J,g as S}from"./app--lA0zENz.js";import{B as K}from"./BasicTable-ceqsBAou.js";import{G as Q}from"./GrowingLoader-CWiifW_R.js";import{P as W}from"./PrimaryIconBtn-zZrE_wsa.js";import{D as X}from"./DefaultInput-OXMKtQjk.js";import{P as Y}from"./Paginate-J0lbL4Dz.js";import{D as Z}from"./DefaultSelect-uFn2hizB.js";import{B as $,I as ee,H as te,R as se,S as re}from"./BasicSelect-ijU6ZuXy.js";import{U as ne,C as v}from"./create-0xKqR-az.js";import{D as oe}from"./DefaultIconInput-VTCAHB3z.js";import{B as ie}from"./BasicInput-y6ZnW6eW.js";import"./ImageInput-q8VLym8J.js";import"./boxCreate-ItwNuwUw.js";import"./boxCreate-cCLV8FGc.js";import"./Loader-lMoZoIfD.js";const ae={components:{BasicSelect:$,BasicInput:ie,IconSelect:ee,DefaultIconInput:oe,Update:ne,Create:v,DefaultSelect:Z,Paginate:Y,DefaultInput:X,PrimaryBtn:N,ModalCentered:L,PrimaryIconBtn:W,PrimaryButton:O,GrowingLoader:Q,BasicTable:K,Page:k,Header:te,Report:se,Search:re,CreateMedicine:v},setup(){return{counterStore:R()}},data(){return{change:!1,isChange:!1,items:[],mloader:!1,item:[],boxItem:[],paginateCount:10,last_page:1,current_page:1,boxLast_page:1,boxCurrent_page:1,column:"id",type:"desc",errors:{date:this.$t("dateRequired"),buy_amount:this.$t("buyAmountError"),buy_price:this.$t("buyPriceError")},loader:!1,boxLoader:!1,boxItems:[],warehouses:Object,suppliers:Object,medicineCategories:[],boxSizes:[],drugCompanies:[],sizeTypes:[],medicines:[],dataErrors:[],paymentTypes:[],amount_paid:0,document:[],sortId:1}},methods:{deleteError(e){this.isChange=!this.isChange,this.dataErrors=this.dataErrors.filter(t=>t!="date"+e&&t!="buy_price"+e&&t!="bu_amount"+e)},async show(){try{const e=await F(this.$route.query.id);e.data.status==5&&(y("info",this.$t("SavedDocumentError")),this.$router.push("/admin/documents")),this.document=e.data}catch(e){d(this,e)}},changePrice(e,t){let c={...this.medicines[t]},h=this.counterStore.inputNumberFormat("medicinePrice"+t,c.buy_price,e);console.log("Amount:",h),c.buy_price=h,this.medicines[t]=c},addItem(e){let t=this.sortId+1,c={...e};c.sortId=t,c.buy_amount=1,this.sortId=t,this.medicines.push(c),this.isChange=!this.isChange},async search(e=""){try{if(this.loader=!0,e=="")return this.indexPaginates(),!0;const t=await documentSearch(e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(y("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return d(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;if((await documentDelete(e)).status){this.indexPaginates(this.current_page),y("success",this.$t("delete"));return}return y("error",this.$t("formError")),!1}catch(t){return d(this,t),!1}},async indexCategoryActives(){try{this.mloader=!0;const e=await G();this.medicineCategories=e.data,this.mloader=!1}catch(e){d(this,e)}},async indexBoxSizesActives(){try{this.mloader=!0;const e=await H();this.boxSizes=e.data,this.mloader=!1}catch(e){d(this,e)}},async indexCompaniesActives(){try{this.mloader=!0;const e=await j();this.drugCompanies=e.data,this.mloader=!1}catch(e){d(this,e)}},async indexTypesActives(){try{this.mloader=!0;const e=await q();this.sizeTypes=e.data,this.mloader=!1}catch(e){d(this,e)}}},mounted(){this.show(),this.indexCategoryActives(),this.indexBoxSizesActives(),this.indexCompaniesActives(),this.indexTypesActives()}},ce={class:"row"},ue={class:"m-0",style:{"text-wrap":"wrap"}},le={class:"font-size-10 m-0",style:{"text-wrap":"wrap"}},de=["value","selected"];function me(e,t,c,h,s,l){const x=i("Header"),A=i("Search"),_=i("BasicInput"),B=i("BasicSelect"),w=i("DefaultIconInput"),z=i("PrimaryIconBtn"),P=i("GrowingLoader"),T=i("BasicTable"),E=i("Report"),D=i("CreateMedicine"),V=i("Page");return m(),b(V,{Title:"",Links:[{path:"/admin/documents",name:e.$t("ImportDocuments"),status:!1},{path:"/",name:e.$t("RegistrationMedicines"),status:!0}]},{default:g(()=>[n("div",ce,[a(x,{document:s.document},null,8,["document"]),a(A,{isChange:s.change,onOnAdd:t[0]||(t[0]=r=>l.addItem(r))},null,8,["isChange"]),a(T,{Th:[e.$t("No"),e.$t("Picture"),e.$t("ModalName"),e.$t("ExpiryDateFinished"),e.$t("BoxSize"),e.$t("BuyPrice"),e.$t("Amount"),e.$t("Subtotal"),e.$t("Settings")],Title:"",Col:"col-lg-12"},{default:g(()=>[(m(!0),f(I,null,C(s.medicines,(r,u)=>(m(),f("tr",null,[n("td",null,p(u+1),1),n("td",null,[n("div",{class:"table_image",style:U("background-image: url("+r.image[0].url+")")},null,4)]),n("td",null,[n("p",ue,p(r.name),1),n("p",le,p(r.generic_name),1)]),n("td",null,[a(_,{Label:"",Name:"date",Type:"date",Value:s.medicines[u].expiry_date_finished,Validated:this.dataErrors.includes("date"+r.sortId)?s.errors:"",onOnInput:o=>s.medicines[u].expiry_date_finished=o},null,8,["Value","Validated","onOnInput"])]),n("td",null,[a(B,{Label:"",Name:"size_type_id",onOnInput:o=>s.medicines[u].box_size_id=o},{default:g(()=>[(m(!0),f(I,null,C(s.boxSizes,o=>(m(),f("option",{value:o.id,selected:o.id==r.box_size_id},p(o.name),9,de))),256))]),_:2},1032,["onOnInput"])]),n("td",null,[a(w,{Label:"",Name:"buy_price",Type:"text",Validated:this.dataErrors.includes("buy_price"+r.sortId)?s.errors:"",Value:h.counterStore.formatNumber(r.buy_price),onOnInput:o=>(l.changePrice(o,u),s.isChange=!s.isChange),inputClass:"medicinePrice"+u},{default:g(()=>[J(p(r.currency.sign),1)]),_:2},1032,["Validated","Value","onOnInput","inputClass"])]),n("td",null,[a(_,{Label:"",Name:"buy_amount",Validated:this.dataErrors.includes("buy_amount"+r.sortId)?s.errors:"",Type:"number",Value:r.buy_amount,onOnInput:o=>(s.medicines[u].buy_amount=o,s.isChange=!s.isChange)},null,8,["Validated","Value","onOnInput"])]),n("td",null,p(h.counterStore.formatNumber(Number(r.buy_price)*Number(r.buy_amount)))+" "+p(r.currency.sign),1),n("td",null,[h.counterStore.hasRole("Documents-update")?(m(),b(z,{key:0,onClick:o=>(s.change=r.id,s.medicines.splice(u,1),l.deleteError(r.sortId)),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):S("",!0)])]))),256)),s.loader?(m(),b(P,{key:0,Cols:"8"})):S("",!0)]),_:1},8,["Th"]),a(E,{onDataErrors:t[1]||(t[1]=r=>s.dataErrors=r),medicines:s.medicines,document:s.document,isChange:s.isChange},null,8,["medicines","document","isChange"])]),a(D,{crud:"create",medicineCategories:s.medicineCategories,boxSizes:s.boxSizes,drugCompanies:s.drugCompanies,sizeTypes:s.sizeTypes,onIndexCategoryActives:t[2]||(t[2]=r=>l.indexCategoryActives()),onIndexCompaniesActives:t[3]||(t[3]=r=>l.indexCompaniesActives()),onIndexBoxSizesActives:t[4]||(t[4]=r=>l.indexBoxSizesActives()),onIndexTypesActives:t[5]||(t[5]=r=>l.indexTypesActives()),mloader:s.mloader,onOnCreate:t[6]||(t[6]=()=>{})},null,8,["medicineCategories","boxSizes","drugCompanies","sizeTypes","mloader"])]),_:1},8,["Links"])}const Pe=M(ae,[["render",me]]);export{Pe as default};
