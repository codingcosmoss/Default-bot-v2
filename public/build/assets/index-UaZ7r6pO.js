import{a as N,M,b as U,P as A}from"./Page-kS-htxF1.js";import{_ as $,u as O,a9 as z,l as n,aa as G,A as d,ab as V,ac as R,ad as F,ae as j,af as q,ag as H,ah as J,ai as K,aj as Q,ak as W,d as p,w as m,r as l,o,a as s,c as f,f as x,F as C,n as X,t as c,e as g,b as w,g as _}from"./app--lA0zENz.js";import{B as Y}from"./BasicTable-ceqsBAou.js";import{G as Z}from"./GrowingLoader-CWiifW_R.js";import{P as ee}from"./PrimaryIconBtn-zZrE_wsa.js";import{U as te,C as se}from"./create-dpQKD53i.js";import{D as ae}from"./DefaultInput-OXMKtQjk.js";import{P as re}from"./Paginate-J0lbL4Dz.js";import{D as ne}from"./DefaultSelect-uFn2hizB.js";import{C as oe}from"./CardBlock-0iXhFgqM.js";import"./ImageInput-q8VLym8J.js";const ie={components:{CardBlock:oe,DefaultSelect:ne,Paginate:re,DefaultInput:ae,PrimaryBtn:N,ModalCentered:M,PrimaryIconBtn:ee,PrimaryButton:U,GrowingLoader:Z,BasicTable:Y,Page:A,Update:te,Create:se},setup(){return{counterStore:O()}},data(){return{items:[],item:[],headers:[1,2,3,4,5,6],paginateCount:10,last_page:1,current_page:1,column:"id",type:"desc",errors:[],loader:!1,totals:[],categories:[],totalLoader:!0,totalId:0,indexModel:"index",currency_id:0}},methods:{async index(){try{const e=await z();this.items=e.data}catch(e){n(this,e)}},async indexCategories(){try{const e=await G();this.categories=e.data}catch(e){n(this,e)}},async getCurrencies(e,t=1){try{if(this.currency_id=e,this.paginateCount=100,this.indexModel="currency",this.totalId=e,this.loader=!0,e==0){this.indexPaginates(1),d("info",this.$t("currenciesAlert"));return}const i=await V(e,t);this.loader=!1,this.current_page=i.data.pagination.current_page,this.last_page=i.data.pagination.last_page,this.items=i.data.items,this.item=i.data.items[0],d("info",this.$t("currenciesAlert"))}catch(i){n(this,i)}},async getTotals(){try{this.totalId=0,this.totalLoader=!0;const e=await R();let t=0;e.data.forEach(h=>{t+=h.total_amount});let i=e.data;i.push({title:"Sum",sign:"",currency_id:0,total_amount:t}),this.totals=i,this.totalLoader=!1}catch(e){n(this,e)}},async indexPaginates(e=1){try{this.indexModel="index",this.loader=!0;const t=await F(this.paginateCount,e);this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items,this.item=t.data.items[0],this.loader=!1}catch(t){n(this,t)}},async orderBys(){try{const e=await j(this.column,this.type);this.items=e.data}catch(e){n(this,e)}},async show(e){try{const t=await q(e);this.item=t.data}catch(t){n(this,t)}},async create(){try{const t=await H({});return t.status?(d("success",this.$t("create")),!0):(this.errors=t.errors,d("error",this.$t("formError")),!1)}catch(e){return n(this,e),!1}},async update(){try{const t=await J({});return t.status?(d("success",this.$t("update")),!0):(this.errors=t.errors,d("error",this.$t("formError")),!1)}catch(e){return n(this,e),!1}},async search(e=""){try{if(this.loader=!0,e=="")return this.indexPaginates(),!0;const t=await K(e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(d("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return n(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;const t=await Q(e);return this.items=t.data,t.status&&(d("success",this.$t("delete")),this.indexPaginates(this.current_page),this.getTotals()),d("error",this.$t("formError")),!1}catch(t){return n(this,t),!1}},async getCategoryExpensies(e){try{e==0&&this.indexPaginates();const t=await W(e);this.items=t.data}catch(t){n(this,t)}}},mounted(){this.indexPaginates(),this.getTotals(),this.indexCategories()}},le={class:"row"},ce={class:"col-lg-3 cursor-pointer"},de=s("div",{class:"card mini-stats-wid"},[s("div",{class:"card-body"},[s("div",{class:"d-flex flex-wrap"},[s("div",{class:"me-3"},[s("p",{class:"mb-2 placeholder"},"Uzbekistani"),s("br"),s("h5",{class:"mb-0 placeholder"},"201 000 сўм")]),s("div",{class:"avatar-sm ms-auto"},[s("div",{class:"avatar-title bg-light rounded-circle text-primary font-size-20"},[s("i",{class:"bx bx-money"})])])])])],-1),ue=[de],he=["onClick"],pe={class:"card-body"},me={class:"d-flex flex-wrap"},ge={class:"me-3"},_e={class:"text-muted mb-2"},fe={class:"mb-0"},ye=s("div",{class:"avatar-sm ms-auto"},[s("div",{class:"avatar-title bg-light rounded-circle text-primary font-size-20"},[s("i",{class:"bx bx-money"})])],-1),xe={value:"10",selected:""},Ce=s("option",{value:"10"},"10",-1),be=s("option",{value:"20"},"20",-1),Pe=s("option",{value:"50"},"50",-1),ve=s("option",{value:"100"},"100",-1),we=s("tr",null,null,-1);function ke(e,t,i,h,r,u){const k=l("DefaultInput"),B=l("DefaultSelect"),S=l("PrimaryBtn"),y=l("PrimaryIconBtn"),b=l("Paginate"),T=l("GrowingLoader"),I=l("BasicTable"),E=l("Update"),D=l("Create"),L=l("Page");return o(),p(L,{Title:""},{default:m(()=>[s("div",le,[r.totalLoader?(o(),f(C,{key:0},x(4,a=>s("div",ce,ue)),64)):(o(!0),f(C,{key:1},x(r.totals,a=>(o(),f("div",{onClick:P=>u.getCurrencies(a.currency_id),class:"col-lg-3 cursor-pointer"},[s("div",{class:X(["card mini-stats-wid",r.totalId==a.currency_id&&"bg-primary-subtle"])},[s("div",pe,[s("div",me,[s("div",ge,[s("p",_e,c(a.title=="Sum"?e.$t("Total"):a.title),1),s("h5",fe,c(h.counterStore.formatNumber(a.total_amount))+" "+c(a.sign),1)]),ye])])],2)],8,he))),256)),g(I,{Th:[e.$t("No"),e.$t("Title"),e.$t("Amount"),e.$t("Date"),e.$t("ExpensesCategory"),e.$t("Settings")],Title:e.$t("Expenses"),Col:"col-lg-12"},{inputs:m(()=>[g(k,{Class:"col-lg-3 col-sm-2 search_input",Label:"",Name:"name",Type:"text",Pholder:"Search...",onOnInput:t[0]||(t[0]=a=>u.search(a))}),g(B,{Label:"",Class:"col-lg-2 col-sm-2",onOnInput:t[1]||(t[1]=a=>(this.paginateCount=a,this.indexPaginates()))},{default:m(()=>[s("option",xe,c(e.$t("NumberDownloads")),1),Ce,be,Pe,ve]),_:1}),w("   ")]),buttons:m(()=>[h.counterStore.hasRole("Expenses-create")?(o(),p(S,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#expenseCreate"},{default:m(()=>[w(c(e.$t("Create")),1)]),_:1})):_("",!0)]),default:m(()=>[(o(!0),f(C,null,x(r.items,(a,P)=>(o(),f("tr",null,[s("td",null,c((r.current_page-1)*r.paginateCount+P+1),1),s("td",null,c(a.title),1),s("td",null,c(h.counterStore.formatNumber(a.amount)+" "+a.currency.sign),1),s("td",null,c(a.date),1),s("td",null,c(a.category),1),s("td",null,[h.counterStore.hasRole("Expenses-update")?(o(),p(y,{key:0,onClick:v=>this.item=a,Icon:"bx bx-edit-alt",Modal:"expenseUpdate"},null,8,["onClick"])):_("",!0),g(y,{onClick:v=>this.$router.push({path:"/admin/expenses/show",query:{id:a.id}}),Icon:"bx bx-show"},null,8,["onClick"]),h.counterStore.hasRole("Expenses-delete")?(o(),p(y,{key:1,onClick:v=>this.delete(a.id),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):_("",!0)])]))),256)),r.last_page!=1&&r.indexModel=="index"?(o(),p(b,{key:0,currentPage:this.current_page,totalPages:this.last_page,onChangePage:t[2]||(t[2]=a=>u.indexPaginates(a))},null,8,["currentPage","totalPages"])):_("",!0),r.last_page!=1&&r.indexModel!="index"?(o(),p(b,{key:1,currentPage:this.current_page,totalPages:this.last_page,onChangePage:t[3]||(t[3]=a=>u.getCurrencies(this.currency_id,a))},null,8,["currentPage","totalPages"])):_("",!0),r.loader?(o(),p(T,{key:2,Cols:"7"})):_("",!0),we]),_:1},8,["Th","Title"])]),g(E,{Item:r.item,onOnUpdate:t[4]||(t[4]=a=>(u.indexPaginates(this.current_page),u.getTotals()))},null,8,["Item"]),g(D,{onOnCreate:t[5]||(t[5]=a=>(u.indexPaginates(this.current_page),u.getTotals()))})]),_:1})}const $e=$(ie,[["render",ke]]);export{$e as default};
