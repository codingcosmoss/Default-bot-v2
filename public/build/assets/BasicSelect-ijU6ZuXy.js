import{_ as g,u as I,o as n,c as o,a as t,t as r,n as p,g as c,A as y,bt as P,l as B,bk as k,e as _,w as f,b,F as V,f as $,r as m,bu as L,bv as M,I as T,d as A,h as N}from"./app--lA0zENz.js";import{a as C}from"./BasicTable-ceqsBAou.js";import{a as x}from"./Page-kS-htxF1.js";import{D}from"./DefaultInput-OXMKtQjk.js";import{D as E}from"./DefaultIconInput-VTCAHB3z.js";import{D as j}from"./DefaultSelect-uFn2hizB.js";import{G as O}from"./GrowingLoader-CWiifW_R.js";const z={setup(){return{counterStore:I()}},props:{document:{type:[Array,Object],default:[]}}},F={class:"col-xl-12"},G={class:"card"},H={class:"card-body"},R={class:"table-responsive"},q={class:"table table-bordered mb-0"},W={key:0};function J(e,a,s,d,i,u){return n(),o("div",F,[t("div",G,[t("div",H,[t("div",R,[t("table",q,[t("thead",null,[t("tr",null,[t("th",null,r(e.$t("Id")),1),t("th",null,r(e.$t("Warehouse")),1),t("th",null,r(e.$t("Supplier")),1),t("th",null,r(e.$t("ImportedDate")),1),t("th",null,r(e.$t("Subtotal")),1),t("th",null,r(e.$t("AmountPaid")),1),t("th",null,r(e.$t("Indebtedness")),1),t("th",null,r(e.$t("Status")),1)])]),t("tbody",null,[s.document.length!=0?(n(),o("tr",W,[t("td",null," #"+r(s.document.id),1),t("td",null,r(s.document.warehouse.name),1),t("td",null,r(s.document.supplier.name),1),t("td",null,r(s.document.date),1),t("td",null,r(d.counterStore.formatNumber(s.document.subtotal))+" "+r(s.document.currency.sign),1),t("td",null,r(d.counterStore.formatNumber(s.document.amount_paid))+" "+r(s.document.currency.sign),1),t("td",null,r(d.counterStore.formatNumber(s.document.loan_amount))+" "+r(s.document.currency.sign),1),t("td",null,[t("span",{class:p([s.document.status==5?"badge-soft-success":"badge-soft-warning","badge badge-pill font-size-11"])},r(s.document.status==5?e.$t("Saved"):e.$t("NotSaved")),3)])])):c("",!0)])])])])])])}const ze=g(z,[["render",J]]),K={components:{DefaultSelect:j,DefaultIconInput:E,DefaultInput:D,PrimaryBtn:x,BtnBox:C},setup(){return{counterStore:I()}},props:{medicines:[Object,Array],document:[Object,Array],isChange:Boolean},data(){return{subtotal:0,errors:[],loader:!1,paid:0,paymentTypes:[],payment_type_id:null,dataErrors:[]}},methods:{validator(){let e=[];return this.medicines.forEach((a,s)=>{(a.expiry_date_finished==null||this.isDateBeforeToday(a.expiry_date_finished))&&e.push("date"+a.sortId),this.isNumber(a.buy_price)||e.push("buy_price"+a.sortId),(!this.isNumber(a.buy_amount)||a.buy_amount<=0)&&e.push("buy_amount"+a.sortId)}),this.dataErrors=e,e.length>0||this.medicines==[]?(y("error",this.$t("formError")),!1):this.paid>this.subtotal?(y("error",this.$t("TheIncreased")),!1):this.paid>0&&this.payment_type_id<1?(y("error",this.$t("PaymentTyperequired")),!1):!0},isNumber(e){const a=parseFloat(e);return!isNaN(a)&&typeof a=="number"},isDateBeforeToday(e){const a=new Date(e),s=new Date;return s.setHours(0,0,0,0),a.setHours(0,0,0,0),a<s},async save(){try{if(this.loader=!0,!this.validator())return this.$emit("dataErrors",this.dataErrors),this.loader=!1,!1;let e={document_id:this.document.id,supplier_id:this.document.supplier_id,warehouse_id:this.document.warehouse_id,payment_type_id:this.payment_type_id,amount_paid:this.paid,medicines:this.medicines,currency_id:this.counterStore.user.currency.id};console.log("Data:",e);const a=await P(e);return a.status?(y("success",this.$t("save")),this.loader=!1,this.$router.push("/admin/documents"),!0):(this.errors=a.errors,y("error",this.$t("formError")),this.loader=!1,!1)}catch(e){return B(this,e),this.loader=!1,!1}},report(){let e=0;this.medicines.forEach(a=>{e+=a.buy_price*a.buy_amount}),this.subtotal=e},addPrice(e){let a=this.counterStore.inputNumberFormat("reportPrice",this.paid,e);this.paid=a},async indexPaymentTypes(){try{this.loader=!0;const e=await k();this.paymentTypes=e.data,this.loader=!1}catch(e){B(this,e)}}},watch:{isChange:function(e,a){this.report()}},mounted(){this.indexPaymentTypes()}},Q={class:"w-100 d-flex justify-content-end"},U={class:"col-xl-5"},X={class:"card"},Y={class:"card-body"},Z={class:"table-responsive"},ee={class:"table table-nowrap mb-0"},te={scope:"row"},ae={scope:"row"},se={scope:"row"},re={scope:"row"},ne=t("option",{selected:"",value:0},"---",-1),oe=["value"],le=t("br",null,null,-1);function ie(e,a,s,d,i,u){const h=m("DefaultIconInput"),S=m("DefaultSelect"),v=m("PrimaryBtn"),w=m("BtnBox");return n(),o("div",Q,[t("div",U,[t("div",X,[t("div",Y,[t("div",Z,[t("table",ee,[t("tbody",null,[t("tr",null,[t("th",te,r(e.$t("Subtotal"))+" :",1),t("td",null,r(d.counterStore.formatNumber(i.subtotal))+" "+r(d.counterStore.user.currency.sign),1)]),t("tr",null,[t("th",ae,r(e.$t("AmountToPaid"))+" :",1),t("td",null,r(d.counterStore.formatNumber(i.subtotal))+" "+r(d.counterStore.user.currency.sign),1)]),t("tr",null,[t("th",se,r(e.$t("Paid"))+" :",1),t("td",null,[_(h,{DefaultIconInput:"",Label:"",Name:"amount_paid",Type:"text",Validated:i.errors,onOnInput:a[0]||(a[0]=l=>(u.addPrice(l),delete this.errors.amount_paid)),inputClass:"reportPrice",Value:d.counterStore.formatNumber(i.paid)},{default:f(()=>[b(r(d.counterStore.user.currency.sign),1)]),_:1},8,["Validated","Value"])])]),t("tr",null,[t("th",re,r(e.$t("PaymentType"))+" :",1),t("td",null,[_(S,{Label:"",Name:"payment_type_id",Validated:i.errors,Value:i.payment_type_id,onOnInput:a[1]||(a[1]=l=>(i.payment_type_id=l,delete this.errors.payment_type_id))},{default:f(()=>[ne,(n(!0),o(V,null,$(i.paymentTypes,l=>(n(),o("option",{value:l.id},r(l.name),9,oe))),256))]),_:1},8,["Validated","Value"])])])])])]),le,_(w,null,{default:f(()=>[_(v,{Loader:i.loader,onClick:a[2]||(a[2]=l=>u.save())},{default:f(()=>[b(r(e.$t("Save")),1)]),_:1},8,["Loader"])]),_:1})])])])])}const Fe=g(K,[["render",ie]]),de={components:{GrowingLoader:O,BtnBox:C,BaseBox:L,DefaultInput:D,PrimaryBtn:x},props:{tableMedicines:Object,isChange:Object},watch:{isChange:function(e,a){console.log("oke",this.tableMedicines),this.medicines=this.medicines.filter(s=>s.id!=this.isChange)}},setup(){return{counterStore:I()}},data(){return{items:[],loader:!1,medicines:[]}},methods:{hasMedicines(e){return!!this.medicines.find(s=>s.id==e.id)},addMedicines(e){this.medicines.push(e),this.$emit("onAdd",e)},async search(e=""){try{this.loader=!0;const a=await M(e);return this.items=a.data,this.loader=!1,a.status?(this.loader=!1,!0):(Alert("error",this.$t("formError")),this.loader=!1,!1)}catch(a){return B(this,a),this.loader=!1,!1}}}},ue={class:"w-100 d-flex mb-2"},ce={class:"col-5",style:{"z-index":"100"}},me={class:"dropdown"},he={class:"dropdown-menu col-lg-12 col-sm-12","aria-labelledby":"dropdownMenuButton",style:{"z-index":"1000"}},_e=["onClick"],fe={class:"d-flex justify-content-center flex-column search_item"},pe={class:"search_p"},ye={class:"search_p_2",style:{"text-wrap":"wrap"}},be={key:0,class:"dropdown-item d-flex justify-content-center"};function ge(e,a,s,d,i,u){const h=m("DefaultInput"),S=m("GrowingLoader"),v=m("PrimaryBtn"),w=m("BtnBox");return n(),o("div",ue,[t("div",ce,[t("div",me,[_(h,{id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",Class:"col-lg-12 col-sm-12   search_input",Label:"",Name:"name",Type:"text",Pholder:e.$t("SearchMedicines"),onOnInput:a[0]||(a[0]=l=>u.search(l))},null,8,["Pholder"]),t("div",he,[(n(!0),o(V,null,$(i.items,l=>(n(),o("a",{class:p(["dropdown-item d-flex align-items-center",u.hasMedicines(l)?"bg-success-subtle":""]),onClick:ke=>u.addMedicines(l)},[t("div",{class:"table_image search_medicines_img",style:T("background-image: url("+l.image[0].url+")")},null,4),t("div",fe,[t("p",pe,r(l.name)+" ("+r(l.drug_company)+")",1),t("p",ye,r(l.generic_name),1)])],10,_e))),256)),i.loader?(n(),o("a",be,[_(S)])):c("",!0)])])]),_(w,null,{default:f(()=>[d.counterStore.hasRole("Medicines-create")?(n(),A(v,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#medicineCreate"},{default:f(()=>[b(r(e.$t("CreateMedicine")),1)]),_:1})):c("",!0)]),_:1})])}const Ge=g(de,[["render",ge]]),Se={props:{isButton:{type:Boolean,default:!1},Class:{type:String,default:"col-lg-12 col-sm-12"},ModalName:{type:String,default:"modal"},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},ve={key:0,class:"form-label"},we=["data-bs-target"],Be={class:"input-group",id:"timepicker-input-group1"},Ne={class:"input-group-text"},Ie={key:1,class:"form-label text-danger"};function Ve(e,a,s,d,i,u){return n(),o("div",{class:p(s.Class)},[t("div",null,[s.Label!=""?(n(),o("label",ve,[b(r(s.Label)+" ",1),s.isButton?(n(),o("a",{key:0,class:"btn btn-primary waves-effect waves-light",role:"button","data-bs-toggle":"modal","data-bs-target":"#"+s.ModalName,style:{padding:"0px 5px","font-size":"10px"}},r(e.$t("Create")),9,we)):c("",!0)])):c("",!0),t("div",Be,[t("select",{class:p(["form-select",s.Validated[s.Name]?"border-danger":""]),onInput:a[0]||(a[0]=h=>this.$emit("onInput",h.target.value))},[N(e.$slots,"default")],34),t("span",Ne,[N(e.$slots,"icon")])]),s.Validated[s.Name]?(n(),o("p",Ie,r(s.Validated[s.Name]),1)):c("",!0)])],2)}const He=g(Se,[["render",Ve]]),$e={props:{isButton:{type:Boolean,default:!1},Class:{type:String,default:"col-lg-12 col-sm-12"},ModalName:{type:String,default:"modal"},Name:{type:[String],default:""},Label:{type:String,default:"Label title"},Pholder:{type:String,default:"enter here..."},Type:{type:String,default:"text"},Value:{type:[String,Number],default:""},Validated:{type:[Array,Object,String],default:[]}}},Ce={key:0,class:"form-label"},xe=["data-bs-target"],De={key:1,class:"form-label text-danger"};function Pe(e,a,s,d,i,u){return n(),o("div",{class:p(s.Class)},[t("div",null,[s.Label!=""?(n(),o("label",Ce,[b(r(s.Label)+" ",1),s.isButton?(n(),o("a",{key:0,class:"btn btn-primary waves-effect waves-light",role:"button","data-bs-toggle":"modal","data-bs-target":"#"+s.ModalName,style:{padding:"0px 5px","font-size":"10px"}},r(e.$t("Create")),9,xe)):c("",!0)])):c("",!0),t("select",{class:p(["form-select",s.Validated[s.Name]?"border-danger":""]),onInput:a[0]||(a[0]=h=>this.$emit("onInput",h.target.value))},[N(e.$slots,"default")],34),s.Validated[s.Name]?(n(),o("p",De,r(s.Validated[s.Name]),1)):c("",!0)])],2)}const Re=g($e,[["render",Pe]]);export{Re as B,ze as H,He as I,Fe as R,Ge as S};
