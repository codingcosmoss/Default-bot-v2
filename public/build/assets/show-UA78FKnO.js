import{a as I,b as T,P as D}from"./Page-oDaSi7Lo.js";import{_ as A,M as L,u as N,aI as U,aq as q,I as a,ar as G,A as o,as as O,at as V,au as M,av as R,aw as F,ax as z,ay as K,aK as j,aA as H,aB as J,c as u,w as h,r as i,o as n,e as r,b as y,d as C,t as c,F as b,a as m,f as Q,g}from"./app-YVDEE9Za.js";import{B as W}from"./BasicTable-ZfmzSUNN.js";import{G as X}from"./GrowingLoader-vQyHSln3.js";import{P as Y}from"./PrimaryIconBtn-p99sUTrH.js";import{U as Z,C as ee}from"./create-PMe5nO-E.js";import{D as te}from"./DefaultInput-p6HHK0Yr.js";import{P as se}from"./Paginate-CHzY4ZgL.js";import{D as re}from"./DefaultSelect-Mq9jguBD.js";import{C as ae}from"./CardBlock-4ht9T8B7.js";import"./ImageInput-8YHD6RYu.js";const ne={components:{CardBlock:ae,DefaultSelect:re,Paginate:se,DefaultInput:te,PrimaryBtn:I,ModalCentered:L,PrimaryIconBtn:Y,PrimaryButton:T,GrowingLoader:X,BasicTable:W,Page:D,Update:Z,Create:ee},setup(){return{counterStore:N()}},data(){return{items:[],item:[],headers:[1,2,3,4,5,6],paginateCount:10,last_page:1,current_page:1,column:"id",type:"desc",errors:[],loader:!1,totals:[],categories:[],text:""}},methods:{expense_categorySearch(){return U},async index(){try{const e=await q();this.items=e.data}catch(e){a(this,e)}},async indexCategories(){try{const e=await G();this.categories=e.data}catch(e){a(this,e)}},async getCurrencies(e){try{if(this.loader=!0,e==0){this.indexPaginates(1),o("info",this.$t("currenciesAlert"));return}const t=await O(e);this.loader=!1,this.items=t.data,o("info",this.$t("currenciesAlert"))}catch(t){a(this,t)}},async getTotals(){try{const e=await V();let t=0;e.data.forEach(l=>{t+=l.total_amount});let f=e.data;f.push({title:"Sum",sign:"",currency_id:0,total_amount:t}),this.totals=f}catch(e){a(this,e)}},async indexPaginates(e=1){try{this.loader=!0;const t=await M(this.paginateCount,e);this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items,this.item=t.data.items[0],this.loader=!1}catch(t){a(this,t)}},async orderBys(){try{const e=await R(this.column,this.type);this.items=e.data}catch(e){a(this,e)}},async show(e){try{const t=await F(e);this.item=t.data}catch(t){a(this,t)}},async create(){try{const t=await z({});return t.status?(o("success",this.$t("create")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return a(this,e),!1}},async update(){try{const t=await K({});return t.status?(o("success",this.$t("update")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return a(this,e),!1}},async search(e=""){try{if(this.loader=!0,e=="")return this.getCategoryExpensies(),!0;this.text=e;const t=await j(this.$route.query.id,e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(o("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return a(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;const t=await H(e);return this.items=t.data,t.status&&(o("success",this.$t("delete")),this.getCategoryExpensies(this.current_page)),o("error",this.$t("formError")),!1}catch(t){return a(this,t),!1}},async getCategoryExpensies(e=1){try{this.loader=!0;const t=await J(this.$route.query.id,e);this.loader=!1,this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items}catch(t){a(this,t)}}},mounted(){this.getCategoryExpensies()}},oe={class:"row"},ie=["onClick"],ce={class:"card mini-stats-wid"},le={class:"card-body"},ue={class:"d-flex flex-wrap"},de={class:"me-3"},pe={class:"text-muted mb-2"},he={class:"mb-0"},me=r("div",{class:"avatar-sm ms-auto"},[r("div",{class:"avatar-title bg-light rounded-circle text-primary font-size-20"},[r("i",{class:"bx bx-money"})])],-1),ge=r("tr",null,null,-1);function ye(e,t,f,l,d,p){const w=i("DefaultInput"),P=i("PrimaryBtn"),_=i("PrimaryIconBtn"),E=i("Paginate"),k=i("GrowingLoader"),B=i("BasicTable"),$=i("Update"),v=i("Create"),S=i("Page");return n(),u(S,{Title:"",Links:[{path:"/admin/expense/categories",name:e.$t("ExpenseCategories"),status:!1},{name:e.$t("Expenses"),status:!0}]},{default:h(()=>[r("div",oe,[(n(!0),y(b,null,C(d.totals,s=>(n(),y("div",{onClick:x=>p.getCurrencies(s.currency_id),class:"col-lg-3 cursor-pointer"},[r("div",ce,[r("div",le,[r("div",ue,[r("div",de,[r("p",pe,c(s.title=="Sum"?e.$t("Total"):s.title),1),r("h5",he,c(l.counterStore.formatNumber(s.total_amount))+" "+c(s.sign),1)]),me])])])],8,ie))),256)),m(B,{Th:[e.$t("Id"),e.$t("Title"),e.$t("Amount"),e.$t("Date"),e.$t("ExpensesCategory"),e.$t("Settings")],Title:e.$t("Expenses"),Col:"col-lg-12"},{inputs:h(()=>[m(w,{Class:"col-lg-3 col-sm-2 search_input",Label:"",Name:"name",Type:"text",Pholder:"Search...",onOnInput:t[0]||(t[0]=s=>p.search(s))})]),buttons:h(()=>[l.counterStore.hasRole("Expenses-create")?(n(),u(P,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#expenseCreate"},{default:h(()=>[Q(c(e.$t("Create")),1)]),_:1})):g("",!0)]),default:h(()=>[(n(!0),y(b,null,C(d.items,s=>(n(),y("tr",null,[r("td",null," #"+c(s.id),1),r("td",null,c(s.title),1),r("td",null,c(l.counterStore.formatNumber(s.amount)+" "+s.currency.sign),1),r("td",null,c(s.date),1),r("td",null,c(s.category),1),r("td",null,[l.counterStore.hasRole("Expenses-update")?(n(),u(_,{key:0,onClick:x=>this.item=s,Icon:"bx bx-edit-alt",Modal:"expenseUpdate"},null,8,["onClick"])):g("",!0),m(_,{onClick:x=>this.$router.push({path:"/admin/expenses/show",query:{id:s.id}}),Icon:"bx bx-show"},null,8,["onClick"]),l.counterStore.hasRole("Expenses-delete")?(n(),u(_,{key:1,onClick:x=>this.delete(s.id),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):g("",!0)])]))),256)),d.last_page!=1?(n(),u(E,{key:0,currentPage:this.current_page,totalPages:this.last_page,onChangePage:t[1]||(t[1]=s=>p.getCategoryExpensies(s))},null,8,["currentPage","totalPages"])):g("",!0),d.loader?(n(),u(k,{key:1,Cols:"7"})):g("",!0),ge]),_:1},8,["Th","Title"])]),m($,{Item:d.item,onOnUpdate:t[2]||(t[2]=s=>p.getCategoryExpensies(this.current_page))},null,8,["Item"]),m(v,{onOnCreate:t[3]||(t[3]=s=>p.getCategoryExpensies(this.current_page))})]),_:1},8,["Links"])}const ve=A(ne,[["render",ye]]);export{ve as default};
