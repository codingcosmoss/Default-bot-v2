import{M as v,C as b,P as N}from"./Page--X10l4un.js";import{_ as p,u as _,o as u,c as d,a as e,t as i,A as k,a8 as w,a2 as S,a9 as I,r as h,b as c,w as x,F as C,D as T,f as P}from"./app-0LpGGDjw.js";import{C as j}from"./ContentBox-m-a-BDzV.js";import{C as $}from"./ContentBlock-KXipVLRL.js";import{T as B}from"./Table-8FsXe3ZK.js";import{P as E}from"./Table-zzApDkIg.js";import{I as A}from"./Input-31EGHoE1.js";import{P as q}from"./PrimaryButton-1I3sGlmq.js";import"./InputDefault-iSTsXjwG.js";import"./Switch-IzpGzEfA.js";import"./CreateForm-TwO3_Ufm.js";import"./Select-vvngwYib.js";import"./Input-qRYOmpW5.js";import"./pagination-01.vue_vue_type_style_index_0_lang-dWoveVZW.js";import"./paginate-nhVISHLA.js";import"./InputText-xylaGTjy.js";import"./Textarea-aoHlS1LH.js";import"./InputTime-SD-dlHVU.js";import"./Table-1oBVR9BR.js";import"./Loader-iMOtN3gY.js";import"./Table-G06PRo43.js";import"./InputColor-IVNUXZRs.js";import"./ShowForm--t2BqqkM.js";import"./PrimaryButton2-iNe1uhPp.js";import"./DangerButton-GRHP1kVZ.js";import"./Checkbox01-89eBkIYd.js";const M={data(){return{order:"asc",search:"",column:"id"}},methods:{getName(s){return _().getName(s)}}},V={class:"grid grid-cols-6 border-b border-stroke dark:border-strokedark sm:grid-cols-6 overflow-x-auto media_header"},z={class:"flex items-center justify-center p-2.5 xl:p-5"},D={class:"font-medium text-black dark:text-white"},K={class:"flex items-center justify-center p-2.5 xl:p-5"},O={class:"font-medium text-black dark:text-white"},F={class:"flex items-center justify-center p-2.5 xl:p-5"},L={class:"font-medium text-black dark:text-white"},H={class:"flex items-center justify-center p-2.5 xl:p-5"},G={class:"font-medium text-black dark:text-white"},J={class:"flex items-center justify-center p-2.5 xl:p-5"},Q={class:"font-medium text-black dark:text-white"},R={class:"flex items-center justify-center p-2.5 xl:p-5"},U={class:"font-medium text-black dark:text-white"};function W(s,t,n,o,l,r){return u(),d("div",V,[e("div",z,[e("p",D,i(r.getName("fio")),1)]),e("div",K,[e("p",O,i(r.getName("position")),1)]),e("div",F,[e("p",L,i(r.getName("login")),1)]),e("div",H,[e("p",G,i(r.getName("color")),1)]),e("div",J,[e("p",Q,i(r.getName("serial_number")),1)]),e("div",R,[e("p",U,i(r.getName("actions")),1)])])}const X=p(M,[["render",W],["__scopeId","data-v-f7c99692"]]),Y={components:{Input:A,PrimaryButton:q,Map01:v,ContentBlock:$,ContentBox:j,Contents:b,TableHeader:X,Treatments:B,Payments:E},setup(){return{counterStore:_()}},data(){return{Patient:[],search:"",column:"sort_order",order:"asc",paginate:10,pagination:{},current_page:1,Treatmets:[],Payments:null,Items:[],Services:[]}},methods:{addCount(s,t){let n=s;const o=document.querySelector(".ui_input"+t.id);Number(n)>Number(t.max_count)&&(o.value=t.max_count,n=t.max_count,k("error",this.getName("ProductMin")));let l=null;this.Services.forEach((r,m)=>{if(r.id==t.id)return l=m,!0}),l==null?this.Services.push({id:t.id,count:n}):this.Services[l].count=n},async saveTreatment(){let s=[];if(this.Items.length>0&&(this.Items.forEach(t=>{let n=null;this.Services.forEach(o=>{if(t.id==o.id)return n=o,!0}),n!=null?s.push({id:n.id,count:n.count>""?n.count:1}):s.push({id:t.id,count:1})}),s.length>0)){let t={items:s,treatment_id:this.$route.query.treatment_id};console.log("DAta:",t);const n=await w(t);console.log("repomse",n),n.status?this.$router.push("/treatmetns"):this.errorObj=n.data}},summCount(){let s=0;return this.Services.forEach(t=>{let n=0;this.Items.forEach(o=>{t.id==o.id&&(n=Number(o.service_total_sum))}),s+=Number(t.count)*n}),s},searchKey(s){let t=null;return this.Services.forEach((n,o)=>{if(n.id==s)return t=o,!0}),t!=null?this.Services[t].count:1},router(){return router},removeItem(s){this.Services=this.Services.filter(t=>t.id!=s),this.Items=this.Items.filter(t=>t.id!=s)},getName(s){return _().getName(s)},async getItem(){const s=await S(this.$route.query.id);this.Patient=s.data,this.Treatmets=s.data.treatmets,this.Payments=s.data.payments},async getItems(){this.Items=[];const s=await I(this.$route.query.treatment_id);this.Items=s.data.items,this.Items.forEach(t=>{this.Services.push({id:t.id,count:t.count})})}},mounted(){this.getItem(),this.getItems()}},Z={class:"col-span-12 xl:col-span-12"},tt={class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",style:{"justify-content":"flex-end"}},et={class:"flex items-center gap-2"},st={class:"font-medium text-primary"},rt={class:"text-title-md font-bold text-black dark:text-white mb-5"},nt={class:"w-full flex justify-content-end",style:{"justify-content":"flex-end"}},it=e("br",null,null,-1),ot={class:"table01 mt-5"},at=e("td",null,null,-1),lt={style:{width:"250px"}},ct={style:{"font-weight":"bold"}},ut={style:{"text-align":"center",width:"100px"}},mt=["onClick"],dt={style:{width:"100%",display:"flex","justify-content":"flex-end"}},ht={style:{color:"#3C50E0","font-weight":"bold","font-size":"30px",margin:"20px 0"}},_t={class:"w-full flex justify-content-end",style:{"justify-content":"flex-end"}};function ft(s,t,n,o,l,r){const m=h("PrimaryButton"),y=h("Input"),g=h("Map01");return u(),d("div",Z,[e("div",tt,[e("nav",null,[e("ol",et,[e("li",null,[e("a",{class:"font-medium cursor-pointer",onClick:t[0]||(t[0]=a=>this.$router.push("/treatmetns"))},i(r.getName("Treatmetns"))+" /",1)]),e("li",st,i(r.getName("Treatment")),1)])])]),e("h4",rt,i(l.Patient.first_name+" "+l.Patient.last_name),1),e("div",nt,[c(m,{style:{width:"150px"},onClick:t[1]||(t[1]=a=>this.$router.push({path:"/treatmetn/add-service",query:{id:this.$route.query.id,treatment_id:s.$route.query.treatment_id}})),Title:r.getName("addService")},null,8,["Title"])]),it,c(g,{Title:r.getName("PatientAbout")},{default:x(()=>[e("table",ot,[e("tr",null,[e("th",null,i(r.getName("services")),1),e("th",null,i(r.getName("ServiceCount")),1),e("th",null,i(r.getName("price")),1),at]),(u(!0),d(C,null,T(l.Items,a=>(u(),d("tr",null,[e("td",null,i(a.name),1),e("td",lt,[c(y,{style:{width:"200px","margin-right":"20px"},Type:"number",Label:"",onOnInput:f=>r.addCount(f,a),Value:r.searchKey(a.id),Class:"ui_input"+a.id},null,8,["onOnInput","Value","Class"])]),e("td",ct,i(o.counterStore.formatNumber(Number(a.service_total_sum)*r.searchKey(a.id)))+" uzs",1),e("td",ut,[e("i",{onClick:f=>r.removeItem(a.id),class:"fa-solid text-danger fa-trash setting-icon cursor-pointer"},null,8,mt)])]))),256))]),e("div",dt,[e("p",ht,i(o.counterStore.formatNumber(r.summCount()))+" uzs ",1)]),e("div",_t,[c(m,{style:{width:"150px"},onClick:t[2]||(t[2]=a=>r.saveTreatment()),Title:r.getName("Save")},null,8,["Title"])])]),_:1},8,["Title"])])}const pt=p(Y,[["render",ft]]),Lt={__name:"index",setup(s){return(t,n)=>(u(),P(N,{Animation:!1},{default:x(()=>[c(pt)]),_:1}))}};export{Lt as default};
