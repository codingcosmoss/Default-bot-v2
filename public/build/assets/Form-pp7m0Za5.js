import{P as E}from"./Page-8n99lQGG.js";import{_ as y,o as a,c as p,a as o,s as v,t as c,v as I,u as N,x as R,A,z as k,B as O,r as d,b as n,F as g,D as x,n as j,f as b,h as C,w as V}from"./app-TemNFbnf.js";import{I as P}from"./Input-kd4mt6Nc.js";import{I as T}from"./InputColor-d1VPOoHj.js";import{I as F}from"./ImageInput-WFQR4nv9.js";import{C as B}from"./Checkbox01-7mbR3o1K.js";import{T as D}from"./Table-ucvpLxN8.js";import"./Input-FG7ZHoFJ.js";import"./InputDefault-tLeF0Vsp.js";import"./Switch-ytQAvUOl.js";import"./CreateForm-QH3CCTcw.js";import"./Select-2LcnBieZ.js";import"./pagination-01.vue_vue_type_style_index_0_lang-ZvTme92P.js";import"./paginate-OCobNe55.js";import"./InputText-v4oYWxFI.js";import"./Select-INjU42Te.js";import"./Textarea-2uEfp-ul.js";import"./InputTime-I--emg10.js";import"./Loader-rZq7vIO3.js";const K={components:{Input:P},props:{Couple:{type:Boolean,default:!0},Title:{type:String,default:"Checkbox title"}}};function q(e,s,l,h,r,t){return a(),p("li",null,[o("input",{type:"checkbox",onInput:s[0]||(s[0]=u=>this.$emit("onCheck",!0))},null,32),v(" Â  "+c(l.Title),1)])}const S=y(K,[["render",q],["__scopeId","data-v-96264efe"]]),z={data(){return{name:"",position:"",login:"",profil_photo_path:"",percent_salary:"",salary_static:"",sort_order:"",isPasswordError:!1,reset_password:"",isLoginError:!1,color:"#FFFFFF",errorObj:{},image:"",photo:"",Roles:[],Permissions:[],PermissionsArr:[],Loader:!1}},components:{Table:D,Checkbox01:B,ImageInput:F,InputColor:T,Checkbox:S,Input:P},methods:{addRoles(e){this.Roles.includes(e)?(this.Roles=this.Roles.filter(s=>s!=e),this.PermissionsArr=this.PermissionsArr.filter(s=>s.role_id!=e)):this.Roles.push(e)},addAllRoles(){this.Roles.length!=16?(this.Roles=[],this.Permissions.forEach(e=>{this.Roles.push(e.id),console.log("Permission>",e.permissions),e.permissions.forEach(s=>{this.PermissionsArr.push({role_id:s.role_id,permission_id:s.id})})})):(this.Roles=[],this.PermissionsArr=[])},async getPermissions(){const e=await I();this.Permissions=e.data},hasPermission(e,s){let l=!1;return this.PermissionsArr.forEach(h=>{h.role_id==e&&h.permission_id==s&&(l=!0)}),!!l},getName(e){return N().getName(e)},testPassword(e){return this.password!=e?this.isPasswordError=!0:this.isPasswordError=!1,this.reset_password=e,this.isPasswordError},async update(){this.Loader=!0;var e={name:this.name,position:this.position,login:this.login,profil_photo_path:this.profil_photo_path,percent_salary:this.percent_salary,salary_static:this.salary_static,sort_order:this.sort_order,color:this.color,image:this.image,roles:this.Roles,permissions:this.PermissionsArr};console.log(e);const s=await R(this.$route.query.id,e);s.status?(A("success","Updated successfully !"),this.$router.push("/employees")):(console.log("data",s.data),this.errorObj=s.data,this.Loader=!1),this.Loader=!1},async sendData(){this.Loader=!0;const e=this.login;(await k({login:e,id:this.$route.query.id})).status?(this.isLoginError=!0,this.Loader=!1):(this.isLoginError=!1,this.update())},async get(){const e=await O(this.$route.query.id),s=e.data;console.log(s),e.status?(this.name=s.name,this.position=s.position,this.login=s.login,this.password=s.password,this.profil_photo_path=s.profil_photo_path,this.percent_salary=s.percent_salary,this.salary_static=s.salary_static,this.sort_order=s.sort_order,this.photo=s.image[0].url,s.roles.forEach(l=>{this.Roles.push(l.id)}),s.permissions.length>0&&s.permissions.forEach(l=>{this.PermissionsArr.push({role_id:l.role_id,permission_id:l.permission_id})}),this.color=s.color==null?"#ffffff":s.color):(console.log("data:",e.data),this.errorObj=e.data)},async testLogin(e){this.login=e,(await k({login:e,id:this.$route.query.id})).status?this.isLoginError=!0:this.isLoginError=!1},hasKey(e){return e in this.errorObj},addPermission(e,s){this.hasPermission(e,s)?this.PermissionsArr=this.PermissionsArr.filter(l=>!(l.role_id==e&&l.permission_id==s)):this.PermissionsArr.push({role_id:e,permission_id:s})}},mounted(){this.get(),this.getPermissions()}},U={class:"breadcrumb-nav mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},G={class:"flex items-center gap-2"},H={class:"font-medium text-primary"},J={class:"grid grid-cols-1 gap-9 sm:grid-cols-2"},M={class:"flex flex-col gap-9"},Q={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},W={class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},X={class:"font-semibold text-black dark:text-white"},Y={action:"#"},Z={class:"p-6.5"},$={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ss={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},es={class:"flex flex-col gap-9"},os={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},rs=o("div",{class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},[o("h3",{class:"font-semibold text-black dark:text-white"})],-1),ts={class:"pt-0 p-6.5"},is={style:{padding:"5px 27px"}},ls=o("br",null,null,-1),ns={style:{width:"100%"}},as={class:"table01",style:{width:"100%"}},ds={style:{"font-weight":"bold","max-width":"120px"}},ms={class:"pl-7 p-6.5",style:{display:"flex","justify-content":"center"}};function ps(e,s,l,h,r,t){const u=d("ImageInput"),m=d("Input"),w=d("InputColor"),f=d("Checkbox01"),L=d("loader-spinning");return a(),p(g,null,[o("div",U,[o("nav",null,[o("ol",G,[o("li",null,[o("a",{class:"font-medium cursor-pointer",onClick:s[0]||(s[0]=i=>this.$router.push("/employees"))},c(t.getName("employees"))+" /",1)]),o("li",H,c(t.getName("create")),1)])])]),o("div",J,[o("div",M,[o("div",Q,[o("div",W,[o("h3",X,c(t.getName("add_employee")),1)]),o("form",Y,[o("div",Z,[n(u,{onImage:s[1]||(s[1]=i=>r.image=i),Photo:r.photo,Label:"Photo"},null,8,["Photo"]),o("div",$,[n(m,{Couple:!1,Label:t.getName("employee_name"),onOnInput:s[2]||(s[2]=i=>r.name=i),isError:t.hasKey("name"),message:r.errorObj.name,Value:r.name},null,8,["Label","isError","message","Value"]),n(m,{Couple:!1,Label:t.getName("Position_employee"),onOnInput:s[3]||(s[3]=i=>r.position=i),isError:t.hasKey("position"),message:r.errorObj.position,Value:r.position},null,8,["Label","isError","message","Value"])]),n(m,{Label:t.getName("login"),onOnInput:s[4]||(s[4]=i=>t.testLogin(i)),Value:r.login,isError:r.isLoginError||r.errorObj.login,message:r.errorObj.login?r.errorObj.login:"Login is available !"},null,8,["Label","Value","isError","message"]),o("div",ss,[n(w,{Type:"color",Couple:!1,Label:t.getName("color"),onOnInput:s[5]||(s[5]=i=>r.color=i),isError:t.hasKey("color"),message:r.errorObj.color,Value:r.color},null,8,["Label","isError","message","Value"]),n(m,{Type:"number",Couple:!1,Label:t.getName("Serial_number"),onOnInput:s[6]||(s[6]=i=>r.sort_order=i),isError:t.hasKey("sort_order"),message:r.errorObj.sort_order,Value:r.sort_order},null,8,["Label","isError","message","Value"])])])])])]),o("div",es,[o("div",os,[rs,o("p",ts,c(t.getName("employee_roles"))+":",1),o("ul",is,[o("li",null,[n(f,{onClick:s[7]||(s[7]=i=>t.addAllRoles()),onCheck:r.Roles.length==16,Title:t.getName("allPermissions")},null,8,["onCheck","Title"])]),ls,o("li",ns,[o("table",as,[(a(!0),p(g,null,x(r.Permissions,i=>(a(),p("tr",null,[o("td",ds,[n(f,{onClick:_=>t.addRoles(i.id),onCheck:r.Roles.includes(i.id),Title:t.getName(i.lang_name),Class:"genderCheckbox"},null,8,["onClick","onCheck","Title"])]),o("td",{class:j(r.Roles.includes(i.id)?"":"td_hidden")},[(a(!0),p(g,null,x(i.permissions,_=>(a(),b(f,{style:{margin:"5px 0"},onClick:_s=>t.addPermission(i.id,_.id),onCheck:t.hasPermission(i.id,_.id),Title:t.getName(_.lang_name),Class:"genderCheckbox"},null,8,["onClick","onCheck","Title"]))),256))],2)]))),256))])])]),o("div",ms,[r.Loader?(a(),b(L,{key:0,style:{margin:"0 auto"}})):C("",!0),r.Loader?C("",!0):(a(),p("button",{key:1,onClick:s[8]||(s[8]=(...i)=>t.sendData&&t.sendData(...i)),class:"flex w-full justify-center rounded bg-primary p-3 font-medium text-gray"},c(t.getName("create")),1))])])])])],64)}const cs=y(z,[["render",ps]]),hs={components:{FormLayouts:cs,Page:E}};function us(e,s,l,h,r,t){const u=d("FormLayouts"),m=d("Page");return a(),b(m,{Classes:!1,Animation:!1},{default:V(()=>[n(u)]),_:1})}const Ts=y(hs,[["render",us]]);export{Ts as default};
