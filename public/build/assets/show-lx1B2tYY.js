import{a as T,M as I,b as D,P as A}from"./Page-6po4WWvc.js";import{_ as L,u as N,ar as U,a9 as G,l as r,aa as O,A as o,ab as V,ac as q,ad as M,ae as R,af as F,ag as j,ah as z,at as H,aj as J,ak as K,d as u,w as p,r as i,o as n,a,c as y,f as C,F as b,e as m,b as Q,t as c,g}from"./app-qjkFfopU.js";import{B as W}from"./BasicTable-DVjjvWl8.js";import{P as X,G as Y}from"./GrowingLoader-C9t3ZqrR.js";import{U as Z,C as ee}from"./create-JJPTbUHr.js";import{D as te}from"./DefaultInput-qAxpax30.js";import{P as se}from"./Paginate-pkoQmS0i.js";import{D as ae}from"./DefaultSelect-QS9w35hK.js";import{C as re}from"./CardBlock-SujWoNNK.js";import"./ImageInput-rzGOIOcx.js";const ne={components:{CardBlock:re,DefaultSelect:ae,Paginate:se,DefaultInput:te,PrimaryBtn:T,ModalCentered:I,PrimaryIconBtn:X,PrimaryButton:D,GrowingLoader:Y,BasicTable:W,Page:A,Update:Z,Create:ee},setup(){return{counterStore:N()}},data(){return{items:[],item:[],headers:[1,2,3,4,5,6],paginateCount:10,last_page:1,current_page:1,column:"id",type:"desc",errors:[],loader:!1,totals:[],categories:[],text:""}},methods:{expense_categorySearch(){return U},async index(){try{const e=await G();this.items=e.data}catch(e){r(this,e)}},async indexCategories(){try{const e=await O();this.categories=e.data}catch(e){r(this,e)}},async getCurrencies(e){try{if(this.loader=!0,e==0){this.indexPaginates(1),o("info",this.$t("currenciesAlert"));return}const t=await V(e);this.loader=!1,this.items=t.data,o("info",this.$t("currenciesAlert"))}catch(t){r(this,t)}},async getTotals(){try{const e=await q();let t=0;e.data.forEach(l=>{t+=l.total_amount});let f=e.data;f.push({title:"Sum",sign:"",currency_id:0,total_amount:t}),this.totals=f}catch(e){r(this,e)}},async indexPaginates(e=1){try{this.loader=!0;const t=await M(this.paginateCount,e);this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items,this.item=t.data.items[0],this.loader=!1}catch(t){r(this,t)}},async orderBys(){try{const e=await R(this.column,this.type);this.items=e.data}catch(e){r(this,e)}},async show(e){try{const t=await F(e);this.item=t.data}catch(t){r(this,t)}},async create(){try{const t=await j({});return t.status?(o("success",this.$t("create")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return r(this,e),!1}},async update(){try{const t=await z({});return t.status?(o("success",this.$t("update")),!0):(this.errors=t.errors,o("error",this.$t("formError")),!1)}catch(e){return r(this,e),!1}},async search(e=""){try{if(this.loader=!0,e=="")return this.getCategoryExpensies(),!0;this.text=e;const t=await H(this.$route.query.id,e);return this.items=t.data,this.loader=!1,t.status?(this.loader=!1,!0):(o("error",this.$t("formError")),this.loader=!1,!1)}catch(t){return r(this,t),this.loader=!1,!1}},async delete(e){try{if(!confirm(this.$t("DeleteAlert")))return!1;const t=await J(e);return this.items=t.data,t.status&&(o("success",this.$t("delete")),this.getCategoryExpensies(this.current_page)),o("error",this.$t("formError")),!1}catch(t){return r(this,t),!1}},async getCategoryExpensies(e=1){try{this.loader=!0;const t=await K(this.$route.query.id,e);this.loader=!1,this.current_page=t.data.pagination.current_page,this.last_page=t.data.pagination.last_page,this.items=t.data.items}catch(t){r(this,t)}}},mounted(){this.getCategoryExpensies()}},oe={class:"row"},ie=["onClick"],ce={class:"card mini-stats-wid"},le={class:"card-body"},ue={class:"d-flex flex-wrap"},de={class:"me-3"},he={class:"text-muted mb-2"},pe={class:"mb-0"},me=a("div",{class:"avatar-sm ms-auto"},[a("div",{class:"avatar-title bg-light rounded-circle text-primary font-size-20"},[a("i",{class:"bx bx-money"})])],-1),ge=a("tr",null,null,-1);function ye(e,t,f,l,d,h){const w=i("DefaultInput"),P=i("PrimaryBtn"),_=i("PrimaryIconBtn"),E=i("Paginate"),k=i("GrowingLoader"),$=i("BasicTable"),B=i("Update"),S=i("Create"),v=i("Page");return n(),u(v,{Title:"",Links:[{path:"/admin/expense/categories",name:e.$t("ExpenseCategories"),status:!1},{name:e.$t("Expenses"),status:!0}]},{default:p(()=>[a("div",oe,[(n(!0),y(b,null,C(d.totals,s=>(n(),y("div",{onClick:x=>h.getCurrencies(s.currency_id),class:"col-lg-3 cursor-pointer"},[a("div",ce,[a("div",le,[a("div",ue,[a("div",de,[a("p",he,c(s.title=="Sum"?e.$t("Total"):s.title),1),a("h5",pe,c(l.counterStore.formatNumber(s.total_amount))+" "+c(s.sign),1)]),me])])])],8,ie))),256)),m($,{Th:[e.$t("Id"),e.$t("Title"),e.$t("Amount"),e.$t("Date"),e.$t("ExpensesCategory"),e.$t("Settings")],Title:e.$t("Expenses"),Col:"col-lg-12"},{inputs:p(()=>[m(w,{Class:"col-lg-3 col-sm-2 search_input",Label:"",Name:"name",Type:"text",Pholder:"Search...",onOnInput:t[0]||(t[0]=s=>h.search(s))})]),buttons:p(()=>[l.counterStore.hasRole("Expenses-create")?(n(),u(P,{key:0,role:"button","data-bs-toggle":"modal","data-bs-target":"#expenseCreate"},{default:p(()=>[Q(c(e.$t("Create")),1)]),_:1})):g("",!0)]),default:p(()=>[(n(!0),y(b,null,C(d.items,s=>(n(),y("tr",null,[a("td",null," #"+c(s.id),1),a("td",null,c(s.title),1),a("td",null,c(l.counterStore.formatNumber(s.amount)+" "+s.currency.sign),1),a("td",null,c(s.date),1),a("td",null,c(s.category),1),a("td",null,[l.counterStore.hasRole("Expenses-update")?(n(),u(_,{key:0,onClick:x=>this.item=s,Icon:"bx bx-edit-alt",Modal:"expenseUpdate"},null,8,["onClick"])):g("",!0),m(_,{onClick:x=>this.$router.push({path:"/admin/expenses/show",query:{id:s.id}}),Icon:"bx bx-show"},null,8,["onClick"]),l.counterStore.hasRole("Expenses-delete")?(n(),u(_,{key:1,onClick:x=>this.delete(s.id),class:"bg-danger border-danger",Icon:"bx bx-trash-alt"},null,8,["onClick"])):g("",!0)])]))),256)),d.last_page!=1?(n(),u(E,{key:0,currentPage:this.current_page,totalPages:this.last_page,onChangePage:t[1]||(t[1]=s=>h.getCategoryExpensies(s))},null,8,["currentPage","totalPages"])):g("",!0),d.loader?(n(),u(k,{key:1,Cols:"7"})):g("",!0),ge]),_:1},8,["Th","Title"])]),m(B,{Item:d.item,onOnUpdate:t[2]||(t[2]=s=>h.getCategoryExpensies(this.current_page))},null,8,["Item"]),m(S,{onOnCreate:t[3]||(t[3]=s=>h.getCategoryExpensies(this.current_page))})]),_:1},8,["Links"])}const Be=L(ne,[["render",ye]]);export{Be as default};
