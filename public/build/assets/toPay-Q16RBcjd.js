import{a as P,M as g,b as D,P as V}from"./Page-kS-htxF1.js";import{_ as b,u as B,bs as S,A as a,l as T,o as i,d as v,w as o,a as u,e as l,b as C,t as m,c,f as M,F as x,r as n}from"./app--lA0zENz.js";import{D as N}from"./DefaultInput-OXMKtQjk.js";import{I as w}from"./ImageInput-q8VLym8J.js";import{a as A}from"./BasicTable-ceqsBAou.js";import{D as E}from"./DefaultSelect-uFn2hizB.js";import{D as L}from"./DefaultIconInput-VTCAHB3z.js";const O={components:{DefaultIconInput:L,DefaultSelect:E,PrimaryBtn:P,BtnBox:A,ModalCentered:g,ImageInput:w,PrimaryButton:D,DefaultInput:N,Page:V},setup(){return{counterStore:B()}},props:{Item:Object,paymentTypes:{type:[Object,Array],default:[]}},data(){return{items:[],item:[],paginateCount:10,column:"id",type:"desc",errors:[],passwordErrors:[],loader:!1,loaderPass:!1,payment_type_id:null,document_id:null,currency_id:null,paid:0,sign:""}},methods:{async toPay(){try{if(this.loader=!0,!this.vatidator()){this.loader=!1;return}let e={payment_type_id:this.payment_type_id,amount:this.paid,supplier_id:this.Item.supplier_id,document_id:this.document_id,currency_id:this.currency_id};console.log("Data:",e);const t=await S(e);return t.status?(this.$emit("onPayment",!0),this.counterStore.hiddenModal("documentToPayModal"),this.discharge(),a("success",this.$t("save")),this.loader=!1,!0):(this.errors=t.errors,a("error",this.$t("formError")),this.loader=!1,!1)}catch(e){return T(this,e),this.loader=!1,!1}},vatidator(){return this.paid==0?(this.errors.amount=this.$t("EnterPaymentAmount"),a("error",this.$t("EnterPaymentAmount")),!1):this.paid>this.Item.loan_amount?(this.errors.amount=this.$t("TheIncreased"),a("error",this.$t("TheIncreased")),!1):(this.errors.amount="",!0)},async save(){this.sign=this.counterStore.user.currency.sign,this.currency_id=this.counterStore.user.currency.id,this.item=this.Item,this.document_id=this.Item.id},discharge(){this.item="",this.document_id=null,this.currency_id=null,this.paid=0,this.errors=[]},addPrice(e){let t=this.counterStore.inputNumberFormat("reportPrice",this.paid,e);this.paid=t}},mounted(){this.discharge()},watch:{Item:function(e,t){this.save()}}},$={class:"row"},k=u("p",{class:"form-label text-danger"},null,-1),F=u("option",{selected:""},"---",-1),j=["value"];function q(e,t,p,h,s,d){const _=n("DefaultIconInput"),y=n("DefaultSelect"),f=n("BaseBox"),I=n("ModalCentered");return i(),v(I,{Title:e.$t("ToPay"),ModalName:"documentToPayModal",onOnModal:t[2]||(t[2]=r=>d.toPay())},{default:o(()=>[u("div",$,[l(f,{Col:"col-xl-12",Title:""},{default:o(()=>[l(_,{DefaultIconInput:"",Label:e.$t("Amount"),Name:"amount",Type:"text",Validated:s.errors,onOnInput:t[0]||(t[0]=r=>(d.addPrice(r),delete this.errors.amount)),inputClass:"reportPrice",Value:h.counterStore.formatNumber(s.paid)},{default:o(()=>[C(m(s.sign),1)]),_:1},8,["Label","Validated","Value"]),k,l(y,{Label:e.$t("PaymentType"),Name:"payment_type_id",Validated:s.errors,Value:s.payment_type_id,onOnInput:t[1]||(t[1]=r=>(s.payment_type_id=r,delete this.errors.payment_type_id))},{default:o(()=>[F,(i(!0),c(x,null,M(p.paymentTypes,r=>(i(),c("option",{value:r.id},m(r.name),9,j))),256))]),_:1},8,["Label","Validated","Value"])]),_:1})])]),_:1},8,["Title"])}const U=b(O,[["render",q]]);export{U as t};
