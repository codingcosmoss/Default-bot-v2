import{a as D,P as S}from"./Page-kS-htxF1.js";import{_ as E,Q as L,u as x,S as V,l as f,K as N,M as I,A as C,N as M,d as y,w as a,r as h,o as d,a as o,e as n,c as m,f as T,F as _,b as B,t as b}from"./app--lA0zENz.js";import{a as U,B as q}from"./BasicTable-ceqsBAou.js";import{P as F}from"./PrimaryIconBtn-zZrE_wsa.js";import{G}from"./GrowingLoader-CWiifW_R.js";import{D as z}from"./DefaultInput-OXMKtQjk.js";import{P as K}from"./PrimaryTable-GA3OkOWW.js";const O={components:{BaseCheck:L,PrimaryTable:K,BtnBox:U,DefaultInput:z,PrimaryBtn:D,GrowingLoader:G,PrimaryIconBtn:F,BasicTable:q,Page:S},setup(){return{counterStore:x()}},data(){return{items:[],item:[],paginateCount:10,column:"id",type:"desc",errors:[],loader:!1,menus:[],permissions:[],isAll:!1,name:""}},methods:{async index(){try{this.loader=!0;const s=await V();this.items=s.data,this.loader=!1}catch(s){f(this,s)}},async show(s){try{const e=await N(this.$route.query.id);this.item=e.data,this.name=e.data.name,e.data.permissions.forEach(t=>{this.permissions.push(t.id),this.menus.push(t.menu_id)})}catch(e){f(this,e)}},async create(){try{this.loader=!0;let s={name:this.name,permissions:this.permissions};const e=await I(s);return e.status?(C("success",this.$t("create")),this.loader=!1,this.$router.push("/admin/roles"),!0):(this.errors=e.errors,this.loader=!1,C("error",this.$t("formError")),!1)}catch(s){return f(this,s),this.loader=!1,!1}},async update(){try{this.loader=!0;let s={name:this.name,permissions:this.permissions};const e=await M(this.$route.query.id,s);return console.log(e),e.status?(this.$router.push("/admin/roles"),C("success",this.$t("update")),this.loader=!1,!0):(this.errors=e.errors,C("error",this.$t("formError")),this.loader=!1,!1)}catch(s){return f(this,s),this.loader=!1,!1}},addPermission(s){this.permissions.find(t=>t==s.id)?this.permissions=this.permissions.filter(t=>t!=s.id):(this.menus.push(s.menu_id),this.permissions.push(s.id))},addAllPermission(){this.isAll=!this.isAll,this.isAll?(this.menus=[],this.permissions=[],this.items.forEach(s=>{this.menus.push(s.id),s.permissions.forEach(e=>{this.permissions.push(e.id)})})):(this.menus=[],this.permissions=[]),console.log("Uzenligi:",this.menus.length)},addMenu(s){this.menus.find(t=>t==s.id)?(this.menus=this.menus.filter(t=>t!=s.id),this.permissions=this.permissions.filter(t=>!s.permissions.find(P=>P.id==t))):(this.menus.push(s.id),s.permissions.forEach(t=>{this.permissions.includes(t.id)||this.permissions.push(t.id)}))}},mounted(){this.index(),this.show()}},Q={class:"row"},R={class:"col-xl-12"},j=o("br",null,null,-1),H={class:"text-primary"},J=o("h4",{class:"card-title mb-4 d-none d-xl-block"}," ",-1),W=o("div",{class:"m-xl-5"},null,-1),X=o("br",null,null,-1),Y={class:"text-primary"},Z=o("br",null,null,-1);function ss(s,e,t,P,l,u){const v=h("DefaultInput"),k=h("BaseBox"),c=h("BaseCheck"),$=h("PrimaryTable"),g=h("PrimaryBtn"),w=h("BtnBox"),A=h("Page");return d(),y(A,{Title:""},{default:a(()=>[o("div",Q,[o("div",R,[n(k,{Col:"col-xl-6",Title:s.$t("Update")},{default:a(()=>[n(v,{Label:s.$t("RoleName"),Name:"name",Type:"text",Validated:l.errors,Value:l.name,onOnInput:e[0]||(e[0]=i=>(l.name=i,delete this.errors.name))},null,8,["Label","Validated","Value"])]),_:1},8,["Title"])]),n(k,{Col:"col-xl-6",Title:s.$t("Permissions")},{default:a(()=>[n(c,{onClick:e[1]||(e[1]=i=>u.addAllPermission()),isCheck:l.isAll,Title:s.$t("MarkAll")},null,8,["isCheck","Title"]),j,n($,{Th:[s.$t("Sections"),s.$t("Permissions")],Title:"Latest Transaction",Col:"col-lg-12"},{default:a(()=>[(d(!0),m(_,null,T(l.items.slice(0,l.items.length/2),i=>(d(),m("tr",null,[o("td",null,[n(c,{Title:s.$t(i.name),onClick:r=>u.addMenu(i),isCheck:this.menus.find(r=>r==i.id)},null,8,["Title","onClick","isCheck"])]),o("td",H,[(d(!0),m(_,null,T(i.permissions,r=>(d(),y(c,{onClick:p=>u.addPermission(r),isCheck:this.permissions.find(p=>p==r.id),Title:s.$t(r.name.toUpperCase())},null,8,["onClick","isCheck","Title"]))),256))])]))),256))]),_:1},8,["Th"])]),_:1},8,["Title"]),n(k,{Col:"col-xl-6",Title:""},{default:a(()=>[J,W,X,n($,{Th:[s.$t("Sections"),s.$t("Permissions")],Title:"Latest Transaction",Col:"col-lg-12"},{default:a(()=>[(d(!0),m(_,null,T(l.items.slice(l.items.length/2,l.items.length),i=>(d(),m("tr",null,[o("td",null,[n(c,{Title:s.$t(i.name),onClick:r=>u.addMenu(i),isCheck:this.menus.find(r=>r==i.id)},null,8,["Title","onClick","isCheck"])]),o("td",Y,[(d(!0),m(_,null,T(i.permissions,r=>(d(),y(c,{onClick:p=>u.addPermission(r),isCheck:this.permissions.find(p=>p==r.id),Title:s.$t(r.name.toUpperCase())},null,8,["onClick","isCheck","Title"]))),256))])]))),256))]),_:1},8,["Th"]),Z,n(w,null,{default:a(()=>[n(g,{class:"btn btn-secondary",onClick:e[2]||(e[2]=i=>this.$router.go(-1))},{default:a(()=>[B(b(s.$t("Close")),1)]),_:1}),B("   "),n(g,{onClick:e[3]||(e[3]=i=>u.update()),Loader:l.loader},{default:a(()=>[B(b(s.$t("Save")),1)]),_:1},8,["Loader"])]),_:1})]),_:1})])]),_:1})}const as=E(O,[["render",ss]]);export{as as default};
