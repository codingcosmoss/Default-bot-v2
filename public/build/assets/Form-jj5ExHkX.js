import{P as w}from"./Page--X10l4un.js";import{I as v}from"./Input-PJy0zj06.js";import{_ as b,o as c,c as d,a as s,s as N,t as p,n as g,k as I,h as y,u as S,R as O,Q as V,K as P,U as j,A as x,r as m,b as u,w as _,F as h,D as k,f as C}from"./app-0LpGGDjw.js";import{P as B}from"./PrimaryButton-1I3sGlmq.js";import{P as F}from"./PrimaryButton2-iNe1uhPp.js";import{D as A}from"./DinamicForm-wHVhUPfR.js";import"./Input-31EGHoE1.js";import"./Loader-iMOtN3gY.js";const T={components:{Input:v},props:{Couple:{type:Boolean,default:!0},Title:{type:String,default:"Checkbox title"}}};function D(n,e,a,l,r,t){return c(),d("li",null,[s("input",{type:"checkbox",onInput:e[0]||(e[0]=i=>this.$emit("onCheck",!0))},null,32),N(" Â  "+p(a.Title),1)])}const K=b(T,[["render",D],["__scopeId","data-v-9f011b16"]]),U={props:{Couple:{type:Boolean,default:!0},Label:{type:String,default:"Input label"},Value:{type:[String,Boolean,Number],default:""},Type:{type:String,default:"text"},isError:{type:Boolean,default:!1}}},q={class:"mb-2.5 block text-black dark:text-white"},M=["value","type"];function z(n,e,a,l,r,t){return c(),d("div",{class:g(a.Couple?"mb-4.5":"w-full xl:w-1/2")},[s("label",q,p(a.Label),1),s("input",{value:a.Value,type:a.Type,class:g([a.isError==!0?"isError":"","rounded border-[1.5px] border-stroke bg-transparent py-20 px-2 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"]),placeholder:"Select subject",onInput:e[0]||(e[0]=i=>this.$emit("onInput",i.target.value)),style:{width:"80px",height:"40px"}},null,42,M)],2)}const Q=b(U,[["render",z]]),R={props:{Couple:{type:Boolean,default:!0},Label:{type:String,default:"Input label"},Value:{type:[String,Boolean,Number],default:""},Type:{type:String,default:"text"},isError:{type:Boolean,default:!1},isLoginError:{type:Boolean,default:!1},message:{type:String,default:""}}},G={class:"mb-2.5 block text-black dark:text-white"},H={key:0,class:"text-danger"};function J(n,e,a,l,r,t){return c(),d("div",{class:g(a.Couple?"mb-4.5":"w-full xl:w-1/2")},[s("label",G,p(a.Label),1),s("select",{onInput:e[0]||(e[0]=i=>this.$emit("onSelect",i.target.value)),class:"w-full rounded border-[1.5px] border-stroke bg-transparent px-5 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary"},[I(n.$slots,"default")],32),a.isError?(c(),d("p",H,p(a.message),1)):y("",!0)],2)}const W=b(R,[["render",J]]),X={data(){return{name:"",order:"",code:"",price:"",category:"",material_price:"",technic_price:"",status:1,isLoginError:!1,errorObj:{},personal_procent:!1,categories:[],personalAllProcents:[],FormErrors:[],summError:!1,Collections:[],CollectionId:0,Loader:!1}},components:{DinamicForm:A,Select:W,PrimaryButton2:F,PrimaryButton:B,InputColor:Q,Checkbox:K,Input:v},methods:{getName(n){return S().getName(n)},async getCategories(){const n=await O(null,1e3);this.categories=n.data.items},async getCollections(){const n=await V(1,1e3);this.Collections=n.data.items},validate(n){if(n.length==0)return!0;let e=[],a=0;return n.forEach((l,r)=>{(l.employee==""||l.procent<0||l.procent==""||l.type=="%"&&l.procent>100||l.procent.length>1&&l.procent.split("")[0]==0)&&e.push(r),l.type=="%"?a+=this.price*Number(l.procent)/100:a+=Number(l.procent),n.forEach((t,i)=>{i!=r&&t.employee==l.employee&&(e.push(r),e.push(i))})}),this.FormErrors=e,e.length==0},async getModel(){var e=(await P(this.$route.query.id)).data;this.name=e.name,this.code=e.code,this.material_price=e.material_price.replace(/\s+/g,""),this.price=e.price.replace(/\s+/g,""),this.status=e.status,this.category=e.category_id,this.order=e.order,this.CollectionId=e.collection_id,this.technic_price=e.technic_price.replace(/\s+/g,"");let a=[];e.personalPrices.forEach((l,r)=>{a.push({employee:l.employee_id,procent:l.amount,type:l.type,index:r})}),this.personalAllProcents=a},async create(){if(this.Loader=!0,this.validate(this.personalAllProcents)){let e=[];this.personalAllProcents.forEach((l,r)=>{let t=0;l.type=="%"?t+=this.price*Number(l.procent)/100:t+=Number(l.procent),e.push({employee_id:l.employee,amount:l.procent,result_price:t,type:l.type})});var n={name:this.name,order:this.order,code:this.code,price:this.price,category_id:this.category,material_price:this.material_price,technic_price:this.technic_price,collection_id:this.CollectionId,status:this.status,personal_procents:e};console.log("Data:",n);const a=await j(this.$route.query.id,n);a.status?(x("success","Updated successfully !"),this.$router.push("/services")):(this.errorObj=a.data,console.log(a.data),x("error","There is an error in the form"),this.Loader=!1)}else this.Loader=!1},hasKey(n){return n in this.errorObj}},mounted(){this.getCategories(),this.getModel(),this.getCollections()}},Y={class:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",style:{"justify-content":"flex-end"}},Z={class:"flex items-center gap-2"},$={class:"font-medium text-primary"},ee={class:"grid grid-cols-1 gap-9 sm:grid-cols-2"},re={class:"flex flex-col gap-9"},te={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},se={class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},oe={class:"font-semibold text-black dark:text-white"},le={action:"#"},ae={class:"p-6.5"},ne={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ie={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},ce=s("option",null,"---",-1),ue=["value","selected"],de={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},pe={class:"mb-4.5 flex flex-col gap-6 xl:flex-row"},me=s("option",{value:null},"---",-1),fe=["value","selected"],be={class:"flex flex-col gap-9"},_e={class:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark"},he=s("div",{class:"border-b border-stroke py-4 px-6.5 dark:border-strokedark"},[s("h3",{class:"font-semibold text-black dark:text-white"})],-1),ge={class:"mb-4.5 flex flex-col gap-6 xl:flex-row p-6.5"},ye=["selected"],xe=["selected"],ke={class:"pl-7 p-6.5",style:{display:"flex","justify-content":"center"}};function ve(n,e,a,l,r,t){const i=m("Input"),f=m("Select"),E=m("DinamicForm"),L=m("loader-spinning");return c(),d(h,null,[s("div",Y,[s("nav",null,[s("ol",Z,[s("li",null,[s("a",{class:"font-medium cursor-pointer",onClick:e[0]||(e[0]=o=>this.$router.push("/services"))},p(t.getName("services"))+" /",1)]),s("li",$,p(t.getName("update")),1)])])]),s("div",ee,[s("div",re,[s("div",te,[s("div",se,[s("h3",oe,p(t.getName("services")),1)]),s("form",le,[s("div",ae,[s("div",ne,[u(i,{Couple:!1,Label:t.getName("name_content"),onOnInput:e[1]||(e[1]=o=>r.name=o),isError:t.hasKey("name"),message:r.errorObj.name,Value:r.name},null,8,["Label","isError","message","Value"]),u(i,{Couple:!1,Label:t.getName("code"),onOnInput:e[2]||(e[2]=o=>r.code=o),isError:t.hasKey("code"),message:r.errorObj.code,Value:r.code},null,8,["Label","isError","message","Value"])]),s("div",ie,[u(i,{Couple:!1,Label:t.getName("price"),onOnInput:e[3]||(e[3]=o=>r.price=o),isError:t.hasKey("price"),message:r.errorObj.price,Value:r.price,Type:"number"},null,8,["Label","isError","message","Value"]),u(f,{Couple:!1,Label:t.getName("category"),onOnSelect:e[4]||(e[4]=o=>this.category=o),isError:t.hasKey("category_id"),message:r.errorObj.category_id},{default:_(()=>[ce,(c(!0),d(h,null,k(r.categories,o=>(c(),d("option",{value:o.id,selected:o.id==this.category},p(o.name),9,ue))),256))]),_:1},8,["Label","isError","message"])]),s("div",de,[u(i,{Couple:!1,Label:t.getName("material_price"),onOnInput:e[5]||(e[5]=o=>r.material_price=o),isError:t.hasKey("material_price"),message:r.errorObj.material_price,Type:"number",Value:r.material_price},null,8,["Label","isError","message","Value"]),u(i,{Couple:!1,Label:t.getName("technic_price"),onOnInput:e[6]||(e[6]=o=>r.technic_price=o),isError:t.hasKey("technic_price"),message:r.errorObj.technic_price,Type:"number",Value:r.technic_price},null,8,["Label","isError","message","Value"])]),s("div",pe,[u(f,{Couple:!1,Label:t.getName("Collection"),onOnSelect:e[7]||(e[7]=o=>this.CollectionId=o),isError:t.hasKey("collection_id"),message:r.errorObj.collection_id},{default:_(()=>[me,(c(!0),d(h,null,k(r.Collections,o=>(c(),d("option",{value:o.id,selected:o.id==this.CollectionId},p(o.name),9,fe))),256))]),_:1},8,["Label","isError","message"])])])])])]),s("div",be,[s("div",_e,[he,s("div",ge,[u(i,{Couple:!1,Type:"number",Label:t.getName("Serial_number"),onOnInput:e[8]||(e[8]=o=>r.order=o),isError:t.hasKey("order"),message:r.errorObj.order,Value:r.order},null,8,["Label","isError","message","Value"]),u(f,{Couple:!1,Label:t.getName("status"),onOnSelect:e[9]||(e[9]=o=>this.status=o)},{default:_(()=>[s("option",{selected:r.status==1,value:1}," Active",8,ye),s("option",{selected:r.status==0,value:0}," Inactive",8,xe)]),_:1},8,["Label"])]),u(E,{personalProcents:r.personalAllProcents,summError:r.summError,errors:r.FormErrors,onData:e[10]||(e[10]=o=>(r.personalAllProcents=o,t.validate(r.personalAllProcents)))},null,8,["personalProcents","summError","errors"]),s("div",ke,[r.Loader?(c(),C(L,{key:0,style:{margin:"0 auto"}})):y("",!0),r.Loader?y("",!0):(c(),d("button",{key:1,onClick:e[11]||(e[11]=(...o)=>t.create&&t.create(...o)),class:"flex w-full justify-center rounded bg-primary p-3 font-medium text-gray"},p(t.getName("update")),1))])])])])],64)}const Ce=b(X,[["render",ve]]),Ee={components:{FormLayouts:Ce,Page:w}};function Le(n,e,a,l,r,t){const i=m("FormLayouts"),f=m("Page");return c(),C(f,{Classes:!1,Animation:!1},{default:_(()=>[u(i)]),_:1})}const Be=b(Ee,[["render",Le]]);export{Be as default};
